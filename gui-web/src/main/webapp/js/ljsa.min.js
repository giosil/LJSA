var GUI
!function(t){var e=function(t){function e(e){return t.call(this,e||"*","GUIAttivita")||this}return __extends(e,t),e.prototype.render=function(){return"<p>GUIAttivita</p>"},e}(WUX.WComponent)
t.GUIAttivita=e}(GUI||(GUI={}))
var GUI
!function(t){function e(){var e=window?window._userLogged:void 0
return e&&"object"==typeof e?e:{id:1,userName:"dew",currLogin:new Date,role:"admin",groups:[t.LJSA_SERVICE],structures:[],email:"test@dew.org",mobile:"3491234567",tokenId:"KURJPghMTJ"}}function i(){var t=window?window._config:void 0
return t&&"object"==typeof t?t:{}}function n(){var t=e()
return null!=t&&t.locale?t.locale:WUX.WUtil.getString(i(),"locale","")}function s(){var t=window?window._userLogged:void 0
return!t||"object"!=typeof t}t.LJSA_SERVICE="LJSA",t.getUserLogged=e,t.getConfig=i,t.getLocale=n,t.isDevMode=s
var o=function(){function t(){}return t.sID_SERVIZIO="id_servizio",t.sDESCRIZIONE="descrizione",t.sATTIVO="attivo",t.sCREDENZIALI="credenziali",t}()
t.IServizio=o}(GUI||(GUI={})),WUX.global.locale=GUI.getLocale()
var jrpc=new JRPC("/LJSA/rpc")
jrpc.setUserName(GUI.getUserLogged().userName),jrpc.setPassword(GUI.getUserLogged().tokenId)
var GUI
!function(t){var e=function(t){function e(e){return t.call(this,e||"*","GUIClassi")||this}return __extends(e,t),e.prototype.render=function(){return"<p>GUIClassi</p>"},e}(WUX.WComponent)
t.GUIClassi=e}(GUI||(GUI={}))
var GUI
!function(t){var e=function(t){function e(e){var i=t.call(this,e,"AppTableActions",null,"table-actions-wrapper")||this
return i.left=new WUX.WContainer(i.subId("l"),"left-actions"),i.right=new WUX.WContainer(i.subId("r"),"right-actions"),i}return __extends(e,t),e.prototype.componentDidMount=function(){var t=$('<div class="table-actions clearfix" data-b2x-sticky-element="1" data-b2x-sticky-element-z-index="3"></div>')
this.root.append(t),this.left.mount(t),this.right.mount(t)},e.prototype.setLeftVisible=function(t){this.left.visible=t},e.prototype.setRightVisible=function(t){this.right.visible=t},e}(WUX.WComponent)
t.AppTableActions=e}(GUI||(GUI={}))
var GUI
!function(t){var e=function(t){function e(e){return t.call(this,e||"*","GUICredenziali")||this}return __extends(e,t),e.prototype.render=function(){return"<p>GUICredenziali</p>"},e}(WUX.WComponent)
t.GUICredenziali=e}(GUI||(GUI={}))
var GUI
!function(t){var e=function(t){function e(e){return t.call(this,e||"*","GUILog")||this}return __extends(e,t),e.prototype.render=function(){return"<p>GUILog</p>"},e}(WUX.WComponent)
t.GUILog=e}(GUI||(GUI={}))
var GUI
!function(t){var e=function(t){function e(e){return t.call(this,e||"*","GUISchedulatore")||this}return __extends(e,t),e.prototype.render=function(){return"<p>GUISchedulatore</p>"},e}(WUX.WComponent)
t.GUISchedulatore=e}(GUI||(GUI={}))
var GUI
!function(t){var e=function(t){function e(e){return t.call(this,e||"*","GUISchedulazioni")||this}return __extends(e,t),e.prototype.render=function(){return"<p>GUISchedulazioni</p>"},e}(WUX.WComponent)
t.GUISchedulazioni=e}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function n(t){var e=i.call(this,t||"*","GUIServizi")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(n,i),n.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(n){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.fpFilter.checkMandatory(!0,!0,!1)
if(s)return void WUX.showWarning("Specificare i seguenti campi: "+s)
var o=WUX.getComponent("boxFilter")
o instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),o.collapse())
var r=t.getUserLogged()
jrpc.execute("SERVIZI.find",[i.fpFilter.getState(),r.groups],function(n){if(i.tabResult.setState(n),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var s=e.indexOf(n,t.IServizio.sID_SERVIZIO,i.selId)
s>=0&&setTimeout(function(){i.tabResult.select([s])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addTextField(t.IServizio.sID_SERVIZIO,"Codice"),this.fpFilter.addTextField(t.IServizio.sDESCRIZIONE,"Descrizione"),this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addTextField(t.IServizio.sID_SERVIZIO,"Codice"),this.fpDetail.addTextField(t.IServizio.sDESCRIZIONE,"Descrizione"),this.fpDetail.enabled=!1,this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var n=i.fpDetail.checkMandatory(!0)
if(n)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+n)
var s=i.fpDetail.getState()
i.isNew?jrpc.execute("SERVIZI.insert",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IServizio.sID_SERVIZIO],i.btnFind.trigger("click")}):jrpc.execute("SERVIZI.update",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IServizio.sID_SERVIZIO]
var n=i.tabResult.getSelectedRows()
if(n&&n.length){var s=n[0]
i.tabResult.getState()[s]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([s])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(n){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.tabResult.getSelectedRowsData()
if(s&&s.length){var o=e.getString(s[0],t.IServizio.sID_SERVIZIO)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("SERVIZI.delete",[o],function(t){i.btnFind.trigger("click")})})}})
var n=[["Codice",t.IServizio.sID_SERVIZIO],["Descrizione",t.IServizio.sDESCRIZIONE]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(n,0),e.col(n,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},n.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},n.prototype.onSelect=function(){var i=this,n=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(n){var s=e.getString(n,t.IServizio.sID_SERVIZIO)
s&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("SERVIZI.read",[s],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},n}(WUX.WComponent)
t.GUIServizi=i}(GUI||(GUI={}))
