var GUI
!function(t){var e=function(t){function e(e){return t.call(this,e||"*","GUIAttivita")||this}return __extends(e,t),e.prototype.render=function(){return"<p>GUIAttivita</p>"},e}(WUX.WComponent)
t.GUIAttivita=e}(GUI||(GUI={}))
var GUI
!function(t){function e(){var e=window?window._userLogged:void 0
return e&&"object"==typeof e?e:{id:1,userName:"dew",currLogin:new Date,role:"admin",groups:[t.LJSA_SERVICE],structures:[],email:"test@dew.org",mobile:"3491234567",tokenId:"KURJPghMTJ"}}function i(){var t=window?window._config:void 0
return t&&"object"==typeof t?t:{}}function n(){var t=e()
return null!=t&&t.locale?t.locale:WUX.WUtil.getString(i(),"locale","")}function s(){var t=window?window._userLogged:void 0
return!t||"object"!=typeof t}function a(t,e,i,n){if(!t||!e||!i)return-1
for(var s=l.toArray(t),a=0;a<s.length;a++){if(l.getValue(s[a],e)+":"+l.getValue(s[a],i)==n)return a}return-1}var l=WUX.WUtil
t.LJSA_SERVICE="LJSA",t._defService="",t.getUserLogged=e,t.getConfig=i,t.getLocale=n,t.isDevMode=s,t.indexOf=a
var r=function(){function t(){}return t.sID_SERVIZIO="id_servizio",t.sDESCRIZIONE="descrizione",t.sATTIVO="attivo",t.sCREDENZIALI="credenziali",t}()
t.IServizio=r
var o=function(){function t(){}return t.sCLASSE="classe",t.sDESCRIZIONE="descrizione",t.sATTIVITA="attivita",t}()
t.IClasse=o
var c=function(){function t(){}return t.sID_SERVIZIO="id_servizio",t.sID_CREDENZIALE="id_credenziale",t.sCREDENZIALI="credenziali",t.sEMAIL="email",t.sATTIVO="attivo",t}()
t.ICredenziale=c}(GUI||(GUI={})),WUX.global.locale=GUI.getLocale()
var jrpc=new JRPC("/LJSA/rpc")
jrpc.setUserName(GUI.getUserLogged().userName),jrpc.setPassword(GUI.getUserLogged().tokenId)
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function n(t){var e=i.call(this,t||"*","GUIClassi")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(n,i),n.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(n){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.fpFilter.checkMandatory(!0,!0,!1)
if(s)return void WUX.showWarning("Specificare i seguenti campi: "+s)
var a=WUX.getComponent("boxFilter")
a instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),a.collapse()),jrpc.execute("CLASSI.find",[i.fpFilter.getState()],function(n){if(i.tabResult.setState(n),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var s=e.indexOf(n,t.IClasse.sCLASSE,i.selId)
s>=0&&setTimeout(function(){i.tabResult.select([s])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addTextField(t.IClasse.sCLASSE,"Classe"),this.fpFilter.addTextField(t.IClasse.sDESCRIZIONE,"Descrizione"),this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addTextField(t.IClasse.sCLASSE,"Classe"),this.fpDetail.addTextField(t.IClasse.sDESCRIZIONE,"Descrizione"),this.fpDetail.enabled=!1,this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var n=i.fpDetail.checkMandatory(!0)
if(n)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+n)
var s=i.fpDetail.getState()
i.isNew?jrpc.execute("CLASSI.insert",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IClasse.sCLASSE],i.btnFind.trigger("click")}):jrpc.execute("CLASSI.update",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IClasse.sCLASSE]
var n=i.tabResult.getSelectedRows()
if(n&&n.length){var s=n[0]
i.tabResult.getState()[s]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([s])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(n){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.tabResult.getSelectedRowsData()
if(s&&s.length){var a=e.getString(s[0],t.IClasse.sCLASSE)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("CLASSI.delete",[a],function(t){i.btnFind.trigger("click")})})}})
var n=[["Classe",t.IClasse.sCLASSE],["Descrizione",t.IClasse.sDESCRIZIONE]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(n,0),e.col(n,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},n.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},n.prototype.onSelect=function(){var i=this,n=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(n){var s=e.getString(n,t.IClasse.sCLASSE)
s&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("CLASSI.read",[s],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},n}(WUX.WComponent)
t.GUIClassi=i}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(t){function e(e){var i=t.call(this,e,"AppTableActions",null,"table-actions-wrapper")||this
return i.left=new WUX.WContainer(i.subId("l"),"left-actions"),i.right=new WUX.WContainer(i.subId("r"),"right-actions"),i}return __extends(e,t),e.prototype.componentDidMount=function(){var t=$('<div class="table-actions clearfix" data-b2x-sticky-element="1" data-b2x-sticky-element-z-index="3"></div>')
this.root.append(t),this.left.mount(t),this.right.mount(t)},e.prototype.setLeftVisible=function(t){this.left.visible=t},e.prototype.setRightVisible=function(t){this.right.visible=t},e}(WUX.WComponent)
t.AppTableActions=i
var n=function(i){function n(t,e){var n=i.call(this,t)||this
return n.multiple=e,n.name="CFSelServizi",n}return __extends(n,i),n.prototype.updateState=function(n){i.prototype.updateState.call(this,n)
var s=e.toString(n)
s||(t._defService=s)},n.prototype.componentDidMount=function(){var e=this,i=t.getUserLogged()
jrpc.execute("SERVIZI.lookup",[i.groups],function(t){for(var i=[],n=0;n<t.length;n++){var s=t[n],a={id:s[0],text:s[2]}
i.push(a)}var l={data:i,placeholder:"",allowClear:!0}
e.init(l)})},n}(WUX.WSelect2)
t.LJSASelServizi=n
var s=function(t){function e(e,i){var n=t.call(this,e,[],i)||this
return n.name="LJSASelClassi",n}return __extends(e,t),e.prototype.componentDidMount=function(){var t={ajax:{dataType:"json",delay:400,processResults:function(t,e){return{results:t}},transport:function(t,e,i){jrpc.execute("CLASSI.lookup",[t.data],e)}},placeholder:"",allowClear:!0,minimumInputLength:3}
this.init(t)},e}(WUX.WSelect2)
t.LJSASelClassi=s
var a=function(e){function i(t,i){var n=e.call(this,t,[],i)||this
return n.name="LJSASelAttivita",n}return __extends(i,e),i.prototype.componentDidMount=function(){var e={ajax:{dataType:"json",delay:400,processResults:function(t,e){return{results:t}},transport:function(e,i,n){jrpc.execute("ATTIVITA.lookup",[t._defService,e.data],i)}},placeholder:"",allowClear:!0,minimumInputLength:3}
this.init(e)},i}(WUX.WSelect2)
t.LJSASelAttivita=a}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function n(t){var e=i.call(this,t||"*","GUICredenziali")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(n,i),n.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var n=i.fpFilter.checkMandatory(!0,!0,!1)
if(n)return void WUX.showWarning("Specificare i seguenti campi: "+n)
var s=WUX.getComponent("boxFilter")
s instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),s.collapse())
var a=t.getUserLogged()
jrpc.execute("CREDENZIALI.find",[i.fpFilter.getState(),a.groups],function(e){if(i.tabResult.setState(e),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var n=t.indexOf(e,t.ICredenziale.sID_SERVIZIO,t.ICredenziale.sID_CREDENZIALE,i.selId)
n>=0&&setTimeout(function(){i.tabResult.select([n])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addComponent(t.ICredenziale.sID_SERVIZIO,"Servizio",new t.LJSASelServizi),this.fpFilter.addTextField(t.ICredenziale.sID_CREDENZIALE,"Credenziale"),this.fpFilter.addTextField(t.ICredenziale.sEMAIL,"Email"),this.selSerDet=new t.LJSASelServizi,this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addComponent(t.ICredenziale.sID_SERVIZIO,"Servizio",this.selSerDet),this.fpDetail.addTextField(t.ICredenziale.sID_CREDENZIALE,"Credenziale"),this.fpDetail.addRow(),this.fpDetail.addPasswordField(t.ICredenziale.sCREDENZIALI,"Password"),this.fpDetail.addTextField(t.ICredenziale.sEMAIL,"Email"),this.fpDetail.enabled=!1,this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),i.selSerDet.setState(t._defService),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var n=i.fpDetail.checkMandatory(!0)
if(n)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+n)
var s=i.fpDetail.getState()
i.isNew?jrpc.execute("CREDENZIALI.insert",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.ICredenziale.sID_SERVIZIO]+":"+e[t.ICredenziale.sID_CREDENZIALE],i.btnFind.trigger("click")}):jrpc.execute("CREDENZIALI.update",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.ICredenziale.sID_SERVIZIO]+":"+e[t.ICredenziale.sID_CREDENZIALE]
var n=i.tabResult.getSelectedRows()
if(n&&n.length){var s=n[0]
i.tabResult.getState()[s]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([s])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(n){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.tabResult.getSelectedRowsData()
if(s&&s.length){var a=e.getString(s[0],t.ICredenziale.sID_SERVIZIO),l=e.getString(s[0],t.ICredenziale.sID_CREDENZIALE)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("CREDENZIALI.delete",[a,l],function(t){i.btnFind.trigger("click")})})}})
var n=[["Servizio",t.ICredenziale.sID_SERVIZIO],["Credenziale",t.ICredenziale.sID_CREDENZIALE],["Email",t.ICredenziale.sEMAIL]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(n,0),e.col(n,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},n.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},n.prototype.onSelect=function(){var i=this,n=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(n){var s=e.getString(n,t.ICredenziale.sID_SERVIZIO),a=e.getString(n,t.ICredenziale.sID_CREDENZIALE)
s&&a&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("CREDENZIALI.read",[s,a],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},n}(WUX.WComponent)
t.GUICredenziali=i}(GUI||(GUI={}))
var GUI
!function(t){var e=function(t){function e(e){return t.call(this,e||"*","GUILog")||this}return __extends(e,t),e.prototype.render=function(){return"<p>GUILog</p>"},e}(WUX.WComponent)
t.GUILog=e}(GUI||(GUI={}))
var GUI
!function(t){var e=function(t){function e(e){return t.call(this,e||"*","GUISchedulatore")||this}return __extends(e,t),e.prototype.render=function(){return"<p>GUISchedulatore</p>"},e}(WUX.WComponent)
t.GUISchedulatore=e}(GUI||(GUI={}))
var GUI
!function(t){var e=function(t){function e(e){return t.call(this,e||"*","GUISchedulazioni")||this}return __extends(e,t),e.prototype.render=function(){return"<p>GUISchedulazioni</p>"},e}(WUX.WComponent)
t.GUISchedulazioni=e}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function n(t){var e=i.call(this,t||"*","GUIServizi")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(n,i),n.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(n){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.fpFilter.checkMandatory(!0,!0,!1)
if(s)return void WUX.showWarning("Specificare i seguenti campi: "+s)
var a=WUX.getComponent("boxFilter")
a instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),a.collapse())
var l=t.getUserLogged()
jrpc.execute("SERVIZI.find",[i.fpFilter.getState(),l.groups],function(n){if(i.tabResult.setState(n),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var s=e.indexOf(n,t.IServizio.sID_SERVIZIO,i.selId)
s>=0&&setTimeout(function(){i.tabResult.select([s])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addTextField(t.IServizio.sID_SERVIZIO,"Codice"),this.fpFilter.addTextField(t.IServizio.sDESCRIZIONE,"Descrizione"),this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addTextField(t.IServizio.sID_SERVIZIO,"Codice"),this.fpDetail.addTextField(t.IServizio.sDESCRIZIONE,"Descrizione"),this.fpDetail.enabled=!1,this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var n=i.fpDetail.checkMandatory(!0)
if(n)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+n)
var s=i.fpDetail.getState()
i.isNew?jrpc.execute("SERVIZI.insert",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IServizio.sID_SERVIZIO],i.btnFind.trigger("click")}):jrpc.execute("SERVIZI.update",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IServizio.sID_SERVIZIO]
var n=i.tabResult.getSelectedRows()
if(n&&n.length){var s=n[0]
i.tabResult.getState()[s]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([s])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(n){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.tabResult.getSelectedRowsData()
if(s&&s.length){var a=e.getString(s[0],t.IServizio.sID_SERVIZIO)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("SERVIZI.delete",[a],function(t){i.btnFind.trigger("click")})})}})
var n=[["Codice",t.IServizio.sID_SERVIZIO],["Descrizione",t.IServizio.sDESCRIZIONE]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(n,0),e.col(n,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},n.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},n.prototype.onSelect=function(){var i=this,n=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(n){var s=e.getString(n,t.IServizio.sID_SERVIZIO)
s&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("SERVIZI.read",[s],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},n}(WUX.WComponent)
t.GUIServizi=i}(GUI||(GUI={}))
