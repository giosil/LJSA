var GUI
!function(t){var e=WUX.WUtil,i=function(i){function a(a){var s=i.call(this,a||"*","GUIAttivita")||this
return s.iSTATUS_STARTUP=0,s.iSTATUS_VIEW=1,s.iSTATUS_EDITING=2,s.status=s.iSTATUS_STARTUP,s.dlgCon=new t.DlgAttCon(s.subId("dlgac")),s.dlgCon.onHiddenModal(function(i){if(s.dlgCon.ok){var a=s.tabCon.getState(),n=s.dlgCon.getState(),o=e.indexOf(a,t.IAtt.sCONF_OPZIONE,n[t.IAtt.sCONF_OPZIONE])
o>=0?a[o]=n:a.push(n),s.tabCon.setState(a)}}),s.dlgPar=new t.DlgAttPar(s.subId("dlgap")),s.dlgPar.onHiddenModal(function(i){if(s.dlgPar.ok){var a=s.tabPar.getState(),n=s.dlgPar.getState(),o=e.indexOf(a,t.IAtt.sPAR_PARAMETRO,n[t.IAtt.sPAR_PARAMETRO])
o>=0?a[o]=n:a.push(n),s.tabPar.setState(a)}}),s.dlgNot=new t.DlgAttNot(s.subId("dlgan")),s.dlgNot.onHiddenModal(function(e){if(s.dlgNot.ok){var i=s.tabNot.getState(),a=s.dlgNot.getState(),n=t.indexOf(i,t.IAtt.sNOT_EVENTO,t.IAtt.sNOT_DESTINAZIONE,a[t.IAtt.sCONF_OPZIONE]+":"+a[t.IAtt.sNOT_DESTINAZIONE])
n>=0?i[n]=a:i.push(a),s.tabNot.setState(i)}}),s}return __extends(a,i),a.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var e=i.fpFilter.checkMandatory(!0,!0,!1)
if(e)return void WUX.showWarning("Specificare i seguenti campi: "+e)
var a=WUX.getComponent("boxFilter")
a instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),a.collapse()),i.selId=null,i.find()}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.clearDet(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addComponent(t.IAtt.sID_SERVIZIO,"Servizio",new t.LJSASelServizi),this.fpFilter.addTextField(t.IAtt.sID_ATTIVITA,"Codice"),this.fpFilter.addTextField(t.IAtt.sDESCRIZIONE,"Descrizione"),this.selSerDet=new t.LJSASelServizi,this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addComponent(t.IAtt.sID_SERVIZIO,"Servizio",this.selSerDet),this.fpDetail.addTextField(t.IAtt.sID_ATTIVITA,"Codice"),this.fpDetail.addRow(),this.fpDetail.addComponent(t.IAtt.sCLASSE,"Classe",new t.LJSASelClassi),this.fpDetail.addTextField(t.IAtt.sDESCRIZIONE,"Descrizione"),this.fpDetail.addInternalField(t.IAtt.sID_CREDENZIALE_INS),this.fpDetail.addInternalField(t.IAtt.sDATA_INS),this.fpDetail.addInternalField(t.IAtt.sORA_INS),this.fpDetail.enabled=!1,this.fpDetail.setMandatory(t.IAtt.sID_SERVIZIO,t.IAtt.sID_ATTIVITA,t.IAtt.sCLASSE,t.IAtt.sDESCRIZIONE),this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.enableDet(!0),i.clearDet(),i.setDefCon(),i.selSerDet.setState(t._defService),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(e){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var a=i.tabResult.getSelectedRows()
if(!a||!a.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.enableDet(!0),i.fpDetail.setEnabled(t.IAtt.sID_SERVIZIO,!1),i.fpDetail.setEnabled(t.IAtt.sID_ATTIVITA,!1),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var a=i.fpDetail.checkMandatory(!0)
if(a)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+a)
var s=i.fpDetail.getState()
s[t.IAtt.sCONFIGURAZIONE]=i.tabCon.getState(),s[t.IAtt.sPARAMETRI]=i.tabPar.getState(),s[t.IAtt.sNOTIFICA]=i.tabNot.getState(),t.putUserLog(s),i.isNew?jrpc.execute("ATTIVITA.insert",[s],function(e){i.status=i.iSTATUS_VIEW,i.enableDet(!1),i.selId=e[t.IAtt.sID_SERVIZIO]+":"+e[t.IAtt.sID_ATTIVITA],i.find()}):jrpc.execute("ATTIVITA.update",[s],function(e){i.status=i.iSTATUS_VIEW,i.enableDet(!1),i.selId=e[t.IAtt.sID_SERVIZIO]+":"+e[t.IAtt.sID_ATTIVITA]
var a=i.tabResult.getSelectedRows()
if(a&&a.length){var s=a[0]
i.tabResult.getState()[s]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([s])},100)}else i.find()})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.clearDet():i.onSelect(),i.status=i.iSTATUS_VIEW,i.enableDet(!1),i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(a){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.tabResult.getSelectedRowsData()
if(s&&s.length){var n=e.getString(s[0],t.IAtt.sID_SERVIZIO),o=e.getString(s[0],t.IAtt.sID_ATTIVITA)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("ATTIVITA.delete",[n,o],function(t){i.find()})})}})
var a=[["Servizio",t.IAtt.sID_SERVIZIO],["Codice",t.IAtt.sID_ATTIVITA],["Descrizione",t.IAtt.sDESCRIZIONE],["Classe",t.IAtt.sCLASSE],["Id Cred. Ins.",t.IAtt.sID_CREDENZIALE_INS],["Data Ins.",t.IAtt.sDATA_INS],["Ora Ins.",t.IAtt.sORA_INS],["Id Cred. Agg.",t.IAtt.sID_CREDENZIALE_AGG],["Data Agg.",t.IAtt.sDATA_AGG],["Ora Agg.",t.IAtt.sORA_AGG]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(a,0),e.col(a,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.tabCon=new WUX.WDXTable(this.subId("tbc"),["Opzione","Descrizione","Valori","Predefinito"],[t.IAtt.sCONF_OPZIONE,t.IAtt.sCONF_DESCRIZIONE,t.IAtt.sCONF_VALORI,t.IAtt.sCONF_PREDEFINITO]),this.tabCon.selectionMode="single",this.tabCon.css({h:240}),this.tabCon.onDoubleClick(function(t){var e=i.tabCon.getSelectedRowsData()
e&&e.length&&(i.dlgCon.setState(e[0]),i.dlgCon.show(i))}),this.btnAddCon=new WUX.WButton(this.subId("bac"),t.TXT.ADD,"",WUX.BTN.SM_PRIMARY),this.btnAddCon.on("click",function(t){i.dlgCon.setState(null),i.dlgCon.show(i)}),this.btnRemCon=new WUX.WButton(this.subId("brc"),t.TXT.REMOVE,"",WUX.BTN.SM_DANGER),this.btnRemCon.on("click",function(t){var e=i.tabCon.getSelectedRows()
if(e&&e.length){var a=i.tabCon.getState()
a.splice(e[0],1),i.tabCon.setState(a)}}),this.tabPar=new WUX.WDXTable(this.subId("tbp"),["Parametro","Descrizione","Valori","Predefinito"],[t.IAtt.sPAR_PARAMETRO,t.IAtt.sPAR_DESCRIZIONE,t.IAtt.sPAR_VALORI,t.IAtt.sPAR_PREDEFINITO]),this.tabPar.selectionMode="single",this.tabPar.css({h:240}),this.tabPar.onDoubleClick(function(t){var e=i.tabPar.getSelectedRowsData()
e&&e.length&&(i.dlgPar.setState(e[0]),i.dlgPar.show(i))}),this.btnAddPar=new WUX.WButton(this.subId("bap"),t.TXT.ADD,"",WUX.BTN.SM_PRIMARY),this.btnAddPar.on("click",function(t){i.dlgPar.setState(null),i.dlgPar.show(i)}),this.btnRemPar=new WUX.WButton(this.subId("brp"),t.TXT.REMOVE,"",WUX.BTN.SM_DANGER),this.btnRemPar.on("click",function(t){var e=i.tabPar.getSelectedRows()
if(e&&e.length){var a=i.tabPar.getState()
a.splice(e[0],1),i.tabPar.setState(a)}}),this.tabNot=new WUX.WDXTable(this.subId("tbn"),["Evento","Destinazione"],[t.IAtt.sNOT_EVENTO,t.IAtt.sNOT_DESTINAZIONE]),this.tabNot.selectionMode="single",this.tabNot.css({h:240}),this.tabNot.onDoubleClick(function(t){var e=i.tabPar.getSelectedRowsData()
e&&e.length&&(i.dlgNot.setState(e[0]),i.dlgNot.show(i))}),this.btnAddNot=new WUX.WButton(this.subId("ban"),t.TXT.ADD,"",WUX.BTN.SM_PRIMARY),this.btnAddNot.on("click",function(t){i.dlgNot.setState(null),i.dlgNot.show(i)}),this.btnRemNot=new WUX.WButton(this.subId("brn"),t.TXT.REMOVE,"",WUX.BTN.SM_DANGER),this.btnRemNot.on("click",function(t){var e=i.tabNot.getSelectedRows()
if(e&&e.length){var a=i.tabNot.getState()
a.splice(e[0],1),i.tabNot.setState(a)}}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.tcoDetail.addTab("Configurazione",WUX.WIcon.WRENCH).addRow().addCol("11",{h:300}).add(this.tabCon).addCol("1",{h:300}).addStack(WUX.CSS.STACK_BTNS,this.btnAddCon,this.btnRemCon),this.tcoDetail.addTab("Parametri",WUX.WIcon.EDIT).addRow().addCol("11",{h:300}).add(this.tabPar).addCol("1",{h:300}).addStack(WUX.CSS.STACK_BTNS,this.btnAddPar,this.btnRemPar),this.tcoDetail.addTab("Notifica",WUX.WIcon.ENVELOPE_O).addRow().addCol("11",{h:300}).add(this.tabNot).addCol("1",{h:300}).addStack(WUX.CSS.STACK_BTNS,this.btnAddNot,this.btnRemNot),this.tcoDetail.on("statechange",function(t){switch(i.tcoDetail.getState()){case 0:break
case 1:i.tabCon.repaint()
break
case 2:i.tabPar.repaint()
break
case 3:i.tabNot.repaint()}}),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},a.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},a.prototype.onSelect=function(){var i=this,a=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(a){var s=e.getString(a,t.IAtt.sID_SERVIZIO),n=e.getString(a,t.IAtt.sID_ATTIVITA)
s&&n&&(this.clearDet(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.enableDet(!1)),jrpc.execute("ATTIVITA.read",[s,n],function(a){a[t.IAtt.sID_SERVIZIO]=t.getIdVal(a,t.IAtt.sID_SERVIZIO),i.fpDetail.setState(a),i.tabCon.setState(e.getArray(a,t.IAtt.sCONFIGURAZIONE)),i.tabPar.setState(e.getArray(a,t.IAtt.sPARAMETRI)),i.tabNot.setState(e.getArray(a,t.IAtt.sNOTIFICA)),i.status=i.iSTATUS_VIEW}))}},a.prototype.clearDet=function(){this.fpDetail.clear(),this.tabCon.setState([]),this.tabPar.setState([]),this.tabNot.setState([])},a.prototype.enableDet=function(t){this.fpDetail.enabled=t,this.tabCon.enabled=t,this.tabPar.enabled=t,this.tabNot.enabled=t},a.prototype.find=function(){var e=this,i=t.getUserLogged()
jrpc.execute("ATTIVITA.find",[this.fpFilter.getState(),i.groups],function(i){if(e.tabResult.setState(i),e.clearDet(),e.status=e.iSTATUS_STARTUP,e.selId){var a=t.indexOf(i,t.IAtt.sID_SERVIZIO,t.IAtt.sID_ATTIVITA,e.selId)
a>=0&&setTimeout(function(){e.tabResult.select([a])},100),e.selId=null}})},a.prototype.setDefCon=function(){for(var e=[["nolog","Se S le elaborazioni NON vengono tracciate in archivio","S, N","N"],["attachFiles","Se S i file prodotti vengono inviati in allegato alla mail","S, N","N"],["attachErrorFiles","Se S i file di errore prodotti vengono inviati in allegato alla mail","S, N","N"],["compressFiles","Se S i file prodotti vengono compressi","S, N","N"],["excludeHolidays","Se S vengono esclusi i giorni festivi","S, N","N"],["single","Se S si bloccano esecuzioni sovrapposte dello stesso job","S, N","N"],["fileInfo","Se S viene creato il file di informazioni predefinito","S, N","N"],["timeout","Timeout di elaborazione espresso in minuti","","0"]],i=[],a=0;a<e.length;a++){var s={}
s[t.IAtt.sCONF_OPZIONE]=e[a][0],s[t.IAtt.sCONF_DESCRIZIONE]=e[a][1],s[t.IAtt.sCONF_VALORI]=e[a][2],s[t.IAtt.sCONF_PREDEFINITO]=e[a][3],i.push(s)}this.tabCon.setState(i)},a}(WUX.WComponent)
t.GUIAttivita=i}(GUI||(GUI={}))
var GUI
!function(t){function e(){var e=window?window._userLogged:void 0
return e&&"object"==typeof e?e:{id:1,userName:"dew",currLogin:new Date,role:"admin",groups:[t.LJSA_SERVICE],structures:[],email:"test@dew.org",mobile:"3491234567",tokenId:"KURJPghMTJ"}}function i(){var t=window?window._config:void 0
return t&&"object"==typeof t?t:{}}function a(){var t=e()
return null!=t&&t.locale?t.locale:WUX.WUtil.getString(i(),"locale","")}function s(){var t=window?window._userLogged:void 0
return!t||"object"!=typeof t}function n(t,e,i,a){if(!t||!e||!i)return-1
for(var s=d.toArray(t),n=0;n<s.length;n++){if(d.getValue(s[n],e)+":"+d.getValue(s[n],i)==a)return n}return-1}function o(t){return t?(t[r.sUSER_LOG]=e().userName,t):t}function l(t,e){if(!t||!e)return t
var i=t[e]
return Array.isArray(i)?i.length>1?i[0]:null:i}var d=WUX.WUtil
t.LJSA_SERVICE="LJSA",t._defService="",t.getUserLogged=e,t.getConfig=i,t.getLocale=a,t.isDevMode=s,t.indexOf=n,t.putUserLog=o,t.getIdVal=l
var r=function(){function t(){}return t.sUSER_LOG="#u",t}()
t.ICommon=r
var c=function(){function t(){}return t.sID_SERVIZIO="id_servizio",t.sDESCRIZIONE="descrizione",t.sATTIVO="attivo",t.sCREDENZIALI="credenziali",t}()
t.IServizio=c
var I=function(){function t(){}return t.sCLASSE="classe",t.sDESCRIZIONE="descrizione",t.sATTIVITA="attivita",t}()
t.IClasse=I
var S=function(){function t(){}return t.sID_SERVIZIO="id_servizio",t.sID_CREDENZIALE="id_credenziale",t.sCREDENZIALI="credenziali",t.sEMAIL="email",t.sATTIVO="attivo",t}()
t.ICredenziale=S
var u=function(){function t(){}return t.sID_SERVIZIO="id_servizio",t.sID_ATTIVITA="id_attivita",t.sDESCRIZIONE="descrizione",t.sCLASSE="classe",t.sATTIVO="attivo",t.sID_CREDENZIALE_INS="id_credenziale_ins",t.sDATA_INS="data_inserimento",t.sORA_INS="ora_inserimento",t.sID_CREDENZIALE_AGG="id_credenziale_agg",t.sDATA_AGG="data_aggiornamento",t.sORA_AGG="ora_aggiornamento",t.sCONFIGURAZIONE="configurazione",t.sCONF_OPZIONE="opzione",t.sCONF_DESCRIZIONE="descrizione",t.sCONF_VALORI="valori",t.sCONF_PREDEFINITO="predefinito",t.sPARAMETRI="parametri",t.sPAR_PARAMETRO="parametro",t.sPAR_DESCRIZIONE="descrizione",t.sPAR_VALORI="valori",t.sPAR_PREDEFINITO="predefinito",t.sNOTIFICA="notifica",t.sNOT_EVENTO="evento",t.sNOT_DESTINAZIONE="destinazione",t}()
t.IAtt=u
var h=function(){function t(){}return t.sID="id_schedulazione",t.sID_SERVIZIO="id_servizio",t.sID_ATTIVITA="id_attivita",t.sSCHEDULAZIONE="schedulazione",t.sDESCRIZIONE="descrizione",t.sID_CREDENZIALE_INS="id_credenziale_ins",t.sDATA_INS="data_inserimento",t.sORA_INS="ora_inserimento",t.sID_CREDENZIALE_AGG="id_credenziale_agg",t.sDATA_AGG="data_aggiornamento",t.sORA_AGG="ora_aggiornamento",t.sSTATO="stato",t.sINIZIO_VALIDITA="inizio_validita",t.sFINE_VALIDITA="fine_validita",t.sDATA_SCHED="data_schedulazione",t.sORA_SCHED="ora_schedulazione",t.sATTIVO="a",t.sPARAMETRI="parametri",t.sPAR_PARAMETRO="parametro",t.sPAR_VALORE="valore",t.sPAR_DA_ATTIVITA="da_attivita",t.sPAR_OVERWRITE="overwrite",t.sPAR_DESCRIZIONE=u.sPAR_DESCRIZIONE,t.sPAR_VALORI=u.sPAR_VALORI,t.sPAR_PREDEFINITO=u.sPAR_PREDEFINITO,t.sCONFIGURAZIONE="configurazione",t.sCONF_OPZIONE="opzione",t.sCONF_VALORE="valore",t.sCONF_DA_ATTIVITA="da_attivita",t.sCONF_OVERWRITE="overwrite",t.sCONF_DESCRIZIONE=u.sCONF_DESCRIZIONE,t.sCONF_VALORI=u.sCONF_VALORI,t.sCONF_PREDEFINITO=u.sCONF_PREDEFINITO,t.sCONF_TIMEOUT="timeout",t.sCONF_STOP_ON_TIMEOUT="stopOnTimeout",t.sCONF_COMPRESS_FILES="compressFiles",t.sCONF_ATTACH_FILES="attachFiles",t.sCONF_ATTACH_ERR_FILES="attachErrorFiles",t.sCONF_FILE_INFO="fileInfo",t.sCONF_NO_LOG="nolog",t.sNOTIFICA="notifica",t.sNOT_EVENTO="evento",t.sNOT_DESTINAZIONE="destinazione",t.sNOT_DA_ATTIVITA="da_attivita",t.sNOT_CANCELLATA="cancellata",t.sESEC_COMPLETATE="esecuzioni_completate",t.sESEC_INTERROTTE="esecuzioni_interrotte",t}()
t.ISched=h
var T=function(){function t(){}return t.sID_LOG="id_log",t.sID_SCHEDULAZIONE="id_schedulazione",t.sDATA_INIZIO="data_inizio",t.sORA_INIZIO="ora_inizio",t.sDATA_FINE="data_fine",t.sORA_FINE="ora_fine",t.sRAPPORTO="rapporto",t.sSTATO="stato",t.sFILES="files",t.sFILES_TIPOLOGIA="tipologia",t.sFILES_NOME_FILE="nome_file",t.sFILES_URL_FILE="url_file",t}()
t.ILog=T}(GUI||(GUI={})),WUX.global.locale=GUI.getLocale()
var jrpc=new JRPC("/LJSA/rpc")
jrpc.setUserName(GUI.getUserLogged().userName),jrpc.setPassword(GUI.getUserLogged().tokenId)
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function a(t){var e=i.call(this,t||"*","GUIClassi")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(a,i),a.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(a){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.fpFilter.checkMandatory(!0,!0,!1)
if(s)return void WUX.showWarning("Specificare i seguenti campi: "+s)
var n=WUX.getComponent("boxFilter")
n instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),n.collapse()),jrpc.execute("CLASSI.find",[i.fpFilter.getState()],function(a){if(i.tabResult.setState(a),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var s=e.indexOf(a,t.IClasse.sCLASSE,i.selId)
s>=0&&setTimeout(function(){i.tabResult.select([s])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addTextField(t.IClasse.sCLASSE,"Classe"),this.fpFilter.addTextField(t.IClasse.sDESCRIZIONE,"Descrizione"),this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addTextField(t.IClasse.sCLASSE,"Classe"),this.fpDetail.addTextField(t.IClasse.sDESCRIZIONE,"Descrizione"),this.fpDetail.enabled=!1,this.fpDetail.setMandatory(t.IClasse.sCLASSE,t.IClasse.sDESCRIZIONE),this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var a=i.fpDetail.checkMandatory(!0)
if(a)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+a)
var s=i.fpDetail.getState()
i.isNew?jrpc.execute("CLASSI.insert",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IClasse.sCLASSE],i.btnFind.trigger("click")}):jrpc.execute("CLASSI.update",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IClasse.sCLASSE]
var a=i.tabResult.getSelectedRows()
if(a&&a.length){var s=a[0]
i.tabResult.getState()[s]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([s])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(a){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.tabResult.getSelectedRowsData()
if(s&&s.length){var n=e.getString(s[0],t.IClasse.sCLASSE)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("CLASSI.delete",[n],function(t){i.btnFind.trigger("click")})})}})
var a=[["Classe",t.IClasse.sCLASSE],["Descrizione",t.IClasse.sDESCRIZIONE]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(a,0),e.col(a,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},a.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},a.prototype.onSelect=function(){var i=this,a=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(a){var s=e.getString(a,t.IClasse.sCLASSE)
s&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("CLASSI.read",[s],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},a}(WUX.WComponent)
t.GUIClassi=i}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(t){function e(e){var i=t.call(this,e,"AppTableActions",null,"table-actions-wrapper")||this
return i.left=new WUX.WContainer(i.subId("l"),"left-actions"),i.right=new WUX.WContainer(i.subId("r"),"right-actions"),i}return __extends(e,t),e.prototype.componentDidMount=function(){var t=$('<div class="table-actions clearfix"></div>')
this.root.append(t),this.left.mount(t),this.right.mount(t)},e.prototype.setLeftVisible=function(t){this.left.visible=t},e.prototype.setRightVisible=function(t){this.right.visible=t},e}(WUX.WComponent)
t.AppTableActions=i
var a=function(i){function a(t,e){var a=i.call(this,t)||this
return a.multiple=e,a.name="LJSASelServizi",a}return __extends(a,i),a.prototype.updateState=function(a){i.prototype.updateState.call(this,a)
var s=e.toString(a)
s&&(t._defService=s)},a.prototype.componentDidMount=function(){var e=this,i=t.getUserLogged()
jrpc.execute("SERVIZI.lookup",[i.groups],function(t){for(var i=[],a=0;a<t.length;a++){var s=t[a],n={id:s[0],text:s[0]}
i.push(n)}var o={data:i,placeholder:"",allowClear:!0}
e.init(o)})},a}(WUX.WSelect2)
t.LJSASelServizi=a
var s=function(t){function e(e,i){var a=t.call(this,e,[],i)||this
return a.name="LJSASelClassi",a}return __extends(e,t),e.prototype.updateState=function(e){e&&(Array.isArray(e)||(e=[e,e])),t.prototype.updateState.call(this,e)},e.prototype.componentDidMount=function(){var t={ajax:{dataType:"json",delay:400,processResults:function(t,e){var i=[]
if(t)for(var a=0;a<t.length;a++)i.push({id:t[a][0],text:t[a][2]})
return{results:i}},transport:function(t,e,i){jrpc.execute("CLASSI.lookup",[t.data.q],e)}},placeholder:"",allowClear:!0,minimumInputLength:3}
this.init(t)},e}(WUX.WSelect2)
t.LJSASelClassi=s
var n=function(i){function a(t,e){var a=i.call(this,t)||this
return a.multiple=e,a.name="LJSASelAttivita",a}return __extends(a,i),Object.defineProperty(a.prototype,"service",{set:function(e){this._serviceS=e,e&&e!=this._serviceL&&(t._defService=e,this.reload(!1))},enumerable:!1,configurable:!0}),a.prototype.updateState=function(a){i.prototype.updateState.call(this,a)
var s=e.toString(a)
s&&(t._defService=s)},a.prototype.componentDidMount=function(){var e=this
jrpc.execute("ATTIVITA.lookup",[t._defService,""],function(i){e._serviceL=t._defService
for(var a=[],s=0;s<i.length;s++){var n=i[s],o={id:n[0],text:n[0]}
a.push(o)}var l={data:a,placeholder:"",allowClear:!0}
e.init(l)})},a}(WUX.WSelect2)
t.LJSASelAttivita=n
var o=function(t){function e(e,i){var a=t.call(this,e)||this
return a.multiple=i,a.name="LJSASelStati",a.options=[{id:"",text:""},{id:"A",text:"(A) Attiva"},{id:"D",text:"(D) Disattivata"},{id:"E",text:"(E) In Esecuzione"}],a}return __extends(e,t),e}(WUX.WSelect2)
t.LJSASelStati=o
var l=function(t){function e(e,i){var a=t.call(this,e)||this
return a.multiple=i,a.name="LJSASelEventi",a.options=[{id:"",text:""},{id:"R",text:"(R) Risultato elaborazione"},{id:"E",text:"(E) Eccezione verificatasi"},{id:"T",text:"(T) Timeout raggiunto"}],a}return __extends(e,t),e}(WUX.WSelect2)
t.LJSASelEventi=l}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function a(t){var e=i.call(this,t||"*","GUICredenziali")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(a,i),a.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var a=i.fpFilter.checkMandatory(!0,!0,!1)
if(a)return void WUX.showWarning("Specificare i seguenti campi: "+a)
var s=WUX.getComponent("boxFilter")
s instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),s.collapse())
var n=t.getUserLogged()
jrpc.execute("CREDENZIALI.find",[i.fpFilter.getState(),n.groups],function(e){if(i.tabResult.setState(e),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var a=t.indexOf(e,t.ICredenziale.sID_SERVIZIO,t.ICredenziale.sID_CREDENZIALE,i.selId)
a>=0&&setTimeout(function(){i.tabResult.select([a])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addComponent(t.ICredenziale.sID_SERVIZIO,"Servizio",new t.LJSASelServizi),this.fpFilter.addTextField(t.ICredenziale.sID_CREDENZIALE,"Credenziale"),this.fpFilter.addTextField(t.ICredenziale.sEMAIL,"Email"),this.selSerDet=new t.LJSASelServizi,this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addComponent(t.ICredenziale.sID_SERVIZIO,"Servizio",this.selSerDet),this.fpDetail.addTextField(t.ICredenziale.sID_CREDENZIALE,"Credenziale"),this.fpDetail.addRow(),this.fpDetail.addPasswordField(t.ICredenziale.sCREDENZIALI,"Password"),this.fpDetail.addTextField(t.ICredenziale.sEMAIL,"Email"),this.fpDetail.enabled=!1,this.fpDetail.setMandatory(t.ICredenziale.sID_SERVIZIO,t.ICredenziale.sID_CREDENZIALE),this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),i.selSerDet.setState(t._defService),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var a=i.fpDetail.checkMandatory(!0)
if(a)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+a)
var s=i.fpDetail.getState()
i.isNew?jrpc.execute("CREDENZIALI.insert",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.ICredenziale.sID_SERVIZIO]+":"+e[t.ICredenziale.sID_CREDENZIALE],i.btnFind.trigger("click")}):jrpc.execute("CREDENZIALI.update",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.ICredenziale.sID_SERVIZIO]+":"+e[t.ICredenziale.sID_CREDENZIALE]
var a=i.tabResult.getSelectedRows()
if(a&&a.length){var s=a[0]
i.tabResult.getState()[s]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([s])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(a){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.tabResult.getSelectedRowsData()
if(s&&s.length){var n=e.getString(s[0],t.ICredenziale.sID_SERVIZIO),o=e.getString(s[0],t.ICredenziale.sID_CREDENZIALE)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("CREDENZIALI.delete",[n,o],function(t){i.btnFind.trigger("click")})})}})
var a=[["Servizio",t.ICredenziale.sID_SERVIZIO],["Credenziale",t.ICredenziale.sID_CREDENZIALE],["Email",t.ICredenziale.sEMAIL]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(a,0),e.col(a,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},a.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},a.prototype.onSelect=function(){var i=this,a=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(a){var s=e.getString(a,t.ICredenziale.sID_SERVIZIO),n=e.getString(a,t.ICredenziale.sID_CREDENZIALE)
s&&n&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("CREDENZIALI.read",[s,n],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},a}(WUX.WComponent)
t.GUICredenziali=i}(GUI||(GUI={}))
var GUI
!function(t){function e(t,e){if(t&&e){for(var i=0;i<t.length;i++)if(t[i][0]==e)return t[i][1]
return""}}var i=WUX.WUtil
t._c=[["attachFiles","Se S i file prodotti vengono inviati in allegato alla mail"],["attachErrorFiles","Se S i file di errore prodotti vengono inviati in allegato alla mail"],["compressFiles","Se S i file prodotti vengono compressi"],["excludeHolidays","Se S vengono esclusi i giorni festivi"],["fileInfo","Se S viene creato il file di informazioni predefinito"],["jdbc.driver","Driver jdbc"],["jdbc.ds","Data Source jdbc"],["jdbc.url","URL jdbc"],["jdbc.user","User jdbc"],["jdbc.password","Passoword jdbc"],["language","Lingua"],["mail.delete","Se S le mail non vengono conservate sul server"],["mail.user","Utente casella di posta elettronica"],["mail.password","Password casella di posta elettronica"],["message","Testo del messaggio di notifica"],["nolog","Se S le elaborazioni NON vengono tracciate in archivio"],["report","Template del report"],["single","Se S si bloccano esecuzioni sovrapposte dello stesso job"],["stopOnTimeout","Interrompe l'elaborazione a timeout raggiunto"],["subject","Oggetto del messaggio di notifica"],["timeout","Timeout di elaborazione espresso in minuti"]],t._p=[["command","Comando di sistema"],["exception","[LJTest] Simulazione di eccezione"],["fromDate","Dalla data (YYYYMMDD)"],["name","Nome"],["sleep","[LJTest] Simulazione elaborazione (s)"],["sql","Comando sql"],["sql.1","Comando sql 1a parte"],["sql.2","Comando sql 2a parte"],["sql.3","Comando sql 3a parte"],["sql.4","Comando sql 4a parte"],["sql.5","Comando sql 5a parte"],["sql.6","Comando sql 6a parte"],["sql.7","Comando sql 7a parte"],["table","Nome tabella"],["text","Testo"],["title","Titolo report"],["toDate","Alla data (YYYYMMDD)"],["type","Tipo report"]],t._c1=e
var a=function(a){function s(s){var n=a.call(this,s,"DlgAttCon")||this
return n.title="Configurazione",n.fp=new WUX.WFormPanel(n.subId("fp")),n.fp.addRow(),n.fp.addTextField(t.IAtt.sCONF_OPZIONE,"Opzione"),n.fp.addRow(),n.fp.addTextField(t.IAtt.sCONF_DESCRIZIONE,"Descrizione"),n.fp.addRow(),n.fp.addTextField(t.IAtt.sCONF_VALORI,"Valori"),n.fp.addRow(),n.fp.addTextField(t.IAtt.sCONF_PREDEFINITO,"Predefinito"),n.fp.setMandatory(t.IAtt.sCONF_OPZIONE,t.IAtt.sCONF_DESCRIZIONE),n.fp.onFocus(t.IAtt.sCONF_OPZIONE,function(e){$(e.target).autocomplete({source:i.col(t._c,0),minLength:1})}),n.fp.onFocus(t.IAtt.sCONF_DESCRIZIONE,function(i){if(n.fp.isBlank(t.IAtt.sCONF_DESCRIZIONE)){var a=n.fp.getValue(t.IAtt.sCONF_OPZIONE),s=e(t._c,a)
s&&setTimeout(function(){n.fp.setValue(t.IAtt.sCONF_DESCRIZIONE,s)})}}),n.body.addRow().addCol("12").add(n.fp),n}return __extends(s,a),s.prototype.updateState=function(t){a.prototype.updateState.call(this,t),this.fp&&(this.fp.clear(),this.fp.setState(this.state))},s.prototype.getState=function(){return this.fp&&(this.state=this.fp.getState()),this.state},s.prototype.onClickOk=function(){var t=this.fp.checkMandatory(!0)
return!t||(WUX.showWarning("Specificare: "+t),!1)},s}(WUX.WDialog)
t.DlgAttCon=a
var s=function(a){function s(s){var n=a.call(this,s,"DlgAttPar")||this
return n.title="Parametro",n.fp=new WUX.WFormPanel(n.subId("fp")),n.fp.addRow(),n.fp.addTextField(t.IAtt.sPAR_PARAMETRO,"Parametro"),n.fp.addRow(),n.fp.addTextField(t.IAtt.sPAR_DESCRIZIONE,"Descrizione"),n.fp.addRow(),n.fp.addTextField(t.IAtt.sPAR_VALORI,"Valori"),n.fp.addRow(),n.fp.addTextField(t.IAtt.sPAR_PREDEFINITO,"Predefinito"),n.fp.setMandatory(t.IAtt.sPAR_PARAMETRO,t.IAtt.sPAR_DESCRIZIONE),n.fp.onFocus(t.IAtt.sPAR_PARAMETRO,function(e){$(e.target).autocomplete({source:i.col(t._p,0),minLength:1})}),n.fp.onFocus(t.IAtt.sPAR_DESCRIZIONE,function(i){if(n.fp.isBlank(t.IAtt.sPAR_DESCRIZIONE)){var a=n.fp.getValue(t.IAtt.sPAR_PARAMETRO),s=e(t._p,a)
s&&setTimeout(function(){n.fp.setValue(t.IAtt.sPAR_DESCRIZIONE,s)})}}),n.body.addRow().addCol("12").add(n.fp),n}return __extends(s,a),s.prototype.updateState=function(t){a.prototype.updateState.call(this,t),this.fp&&(this.fp.clear(),this.fp.setState(this.state))},s.prototype.getState=function(){return this.fp&&(this.state=this.fp.getState()),this.state},s.prototype.onClickOk=function(){var t=this.fp.checkMandatory(!0)
return!t||(WUX.showWarning("Specificare: "+t),!1)},s}(WUX.WDialog)
t.DlgAttPar=s
var n=function(e){function i(i){var a=e.call(this,i,"DlgAttNot")||this
return a.title="Notifica",a.fp=new WUX.WFormPanel(a.subId("fp")),a.fp.addRow(),a.fp.addComponent(t.IAtt.sNOT_EVENTO,"Evento",new t.LJSASelEventi),a.fp.addRow(),a.fp.addTextField(t.IAtt.sNOT_DESTINAZIONE,"Destinazione"),a.fp.setMandatory(t.IAtt.sNOT_EVENTO,t.IAtt.sNOT_DESTINAZIONE),a.body.addRow().addCol("12").add(a.fp),a}return __extends(i,e),i.prototype.updateState=function(t){e.prototype.updateState.call(this,t),this.fp&&(this.fp.clear(),this.fp.setState(this.state))},i.prototype.getState=function(){return this.fp&&(this.state=this.fp.getState()),this.state},i.prototype.onClickOk=function(){var t=this.fp.checkMandatory(!0)
return!t||(WUX.showWarning("Specificare: "+t),!1)},i}(WUX.WDialog)
t.DlgAttNot=n
var o=function(a){function s(s){var n=a.call(this,s,"DlgSchedCon")||this
return n.title="Configurazione",n.fp=new WUX.WFormPanel(n.subId("fp")),n.fp.addRow(),n.fp.addTextField(t.ISched.sCONF_OPZIONE,"Opzione"),n.fp.addRow(),n.fp.addTextField(t.ISched.sCONF_DESCRIZIONE,"Descrizione",!0),n.fp.addRow(),n.fp.addTextField(t.ISched.sCONF_VALORI,"Valori",!0),n.fp.addRow(),n.fp.addTextField(t.ISched.sCONF_VALORE,"Valore"),n.fp.setMandatory(t.ISched.sCONF_OPZIONE,t.ISched.sCONF_DESCRIZIONE),n.fp.onFocus(t.ISched.sCONF_OPZIONE,function(e){$(e.target).autocomplete({source:i.col(t._c,0),minLength:1})}),n.fp.onFocus(t.ISched.sCONF_DESCRIZIONE,function(i){if(n.fp.isBlank(t.ISched.sCONF_DESCRIZIONE)){var a=n.fp.getValue(t.ISched.sCONF_OPZIONE),s=e(t._c,a)
s&&setTimeout(function(){n.fp.setValue(t.ISched.sCONF_DESCRIZIONE,s)})}}),n.body.addRow().addCol("12").add(n.fp),n}return __extends(s,a),s.prototype.updateState=function(t){a.prototype.updateState.call(this,t),this.fp&&(this.fp.clear(),this.fp.setState(this.state))},s.prototype.getState=function(){return this.fp&&(this.state=this.fp.getState()),this.state},s.prototype.onClickOk=function(){var t=this.fp.checkMandatory(!0)
return!t||(WUX.showWarning("Specificare: "+t),!1)},s}(WUX.WDialog)
t.DlgSchedCon=o
var l=function(a){function s(s){var n=a.call(this,s,"DlgSchedPar")||this
return n.title="Parametro",n.fp=new WUX.WFormPanel(n.subId("fp")),n.fp.addRow(),n.fp.addTextField(t.ISched.sPAR_PARAMETRO,"Parametro"),n.fp.addRow(),n.fp.addTextField(t.ISched.sPAR_DESCRIZIONE,"Descrizione",!0),n.fp.addRow(),n.fp.addTextField(t.ISched.sPAR_VALORI,"Valori",!0),n.fp.addRow(),n.fp.addTextField(t.ISched.sPAR_VALORE,"Valore"),n.fp.setMandatory(t.ISched.sPAR_PARAMETRO,t.ISched.sPAR_DESCRIZIONE),n.fp.onFocus(t.ISched.sPAR_PARAMETRO,function(e){$(e.target).autocomplete({source:i.col(t._p,0),minLength:1})}),n.fp.onFocus(t.ISched.sPAR_DESCRIZIONE,function(i){if(n.fp.isBlank(t.ISched.sPAR_DESCRIZIONE)){var a=n.fp.getValue(t.ISched.sPAR_PARAMETRO),s=e(t._p,a)
s&&setTimeout(function(){n.fp.setValue(t.ISched.sPAR_DESCRIZIONE,s)})}}),n.body.addRow().addCol("12").add(n.fp),n}return __extends(s,a),s.prototype.updateState=function(t){a.prototype.updateState.call(this,t),this.fp&&(this.fp.clear(),this.fp.setState(this.state))},s.prototype.getState=function(){return this.fp&&(this.state=this.fp.getState()),this.state},s.prototype.onClickOk=function(){var t=this.fp.checkMandatory(!0)
return!t||(WUX.showWarning("Specificare: "+t),!1)},s}(WUX.WDialog)
t.DlgSchedPar=l
var d=function(e){function i(i){var a=e.call(this,i,"DlgSchedNot")||this
return a.title="Notifica",a.fp=new WUX.WFormPanel(a.subId("fp")),a.fp.addRow(),a.fp.addComponent(t.ISched.sNOT_EVENTO,"Evento",new t.LJSASelEventi),a.fp.addRow(),a.fp.addTextField(t.ISched.sNOT_DESTINAZIONE,"Destinazione"),a.fp.setMandatory(t.ISched.sNOT_EVENTO,t.ISched.sNOT_DESTINAZIONE),a.body.addRow().addCol("12").add(a.fp),a}return __extends(i,e),i.prototype.updateState=function(t){e.prototype.updateState.call(this,t),this.fp&&(this.fp.clear(),this.fp.setState(this.state))},i.prototype.getState=function(){return this.fp&&(this.state=this.fp.getState()),this.state},i.prototype.onClickOk=function(){var t=this.fp.checkMandatory(!0)
return!t||(WUX.showWarning("Specificare: "+t),!1)},i}(WUX.WDialog)
t.DlgSchedNot=d
var r=function(e){function a(a){var s=e.call(this,a,"DlgSchedLog")||this
s.title="Log Schedulazione",s.lblMain=new WUX.WLabel(s.subId("lm")),s.lblMain.css(WUX.CSS.LABEL_INFO)
var n=[["Id Log",t.ILog.sID_LOG,"s"],["Data Inizio",t.ILog.sDATA_INIZIO,"d"],["Ora Inizio",t.ILog.sORA_INIZIO,"s"],["Data Fine",t.ILog.sDATA_FINE,"d"],["Ora Fine",t.ILog.sORA_FINE,"s"],["Stato",t.ILog.sSTATO,"s"],["Rapporto",t.ILog.sRAPPORTO,"s"]]
return s.tabData=new WUX.WDXTable(s.subId("tac"),i.col(n,0),i.col(n,1)),s.tabData.types=i.col(n,2),s.tabData.css({h:400}),s.tabData.exportFile="log_schedulazione",s.tabData.onCellPrepared(function(e){e.column.dataField==t.ILog.sID_LOG&&e.cellElement.addClass("clickable")}),s.tabData.onCellClick(function(e){var a=e.row
if(null!=a&&"data"==a.rowType){if(e.column.dataField==t.ILog.sID_LOG){var s=i.getString(e.data,t.ILog.sFILES)
s?WUX.openURL(s,!1,!0):WUX.showWarning("File non disponibili")}}}),s.body.addRow().addCol("12",{a:"right"}).add(s.lblMain).addDiv(8).addRow().addCol("12").add(s.tabData),s}return __extends(a,e),a.prototype.updateProps=function(t){e.prototype.updateProps.call(this,t),this.lblMain&&(this.props?this.lblMain.setState("Id Schedulazione: "+this.props):this.lblMain.setState(""))},a.prototype.updateState=function(t){e.prototype.updateState.call(this,t),this.tabData&&this.tabData.setState(this.state)},a.prototype.getState=function(){return this.tabData&&(this.state=this.tabData.getState()),this.state},a.prototype.onShown=function(){var t=this
this.tabData.scrollTo(0),setTimeout(function(){t.state&&t.state.length?t.tabData.refresh():t.tabData.repaint()},100)},a.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this),$(window).width()>1260?this.cntMain.css({w:1260,h:600}):this.cntMain.css({w:1e3,h:600})},a}(WUX.WDialog)
t.DlgSchedLog=r}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function a(a){var s=i.call(this,a||"*","GUISchedulazioni")||this
return s.iSTATUS_STARTUP=0,s.iSTATUS_VIEW=1,s.iSTATUS_EDITING=2,s.status=s.iSTATUS_STARTUP,s.dlgCon=new t.DlgSchedCon(s.subId("dlgsc")),s.dlgCon.onHiddenModal(function(i){if(s.dlgCon.ok){var a=s.tabCon.getState(),n=s.dlgCon.getState(),o=e.indexOf(a,t.ISched.sCONF_OPZIONE,n[t.ISched.sCONF_OPZIONE])
o>=0?a[o]=n:a.push(n),s.tabCon.setState(a)}}),s.dlgPar=new t.DlgSchedPar(s.subId("dlgsp")),s.dlgPar.onHiddenModal(function(i){if(s.dlgPar.ok){var a=s.tabPar.getState(),n=s.dlgPar.getState(),o=e.indexOf(a,t.ISched.sPAR_PARAMETRO,n[t.ISched.sPAR_PARAMETRO])
o>=0?a[o]=n:a.push(n),s.tabPar.setState(a)}}),s.dlgNot=new t.DlgSchedNot(s.subId("dlgsn")),s.dlgNot.onHiddenModal(function(e){if(s.dlgNot.ok){var i=s.tabNot.getState(),a=s.dlgNot.getState(),n=t.indexOf(i,t.ISched.sNOT_EVENTO,t.ISched.sNOT_DESTINAZIONE,a[t.ISched.sCONF_OPZIONE]+":"+a[t.ISched.sNOT_DESTINAZIONE])
n>=0?i[n]=a:i.push(a),s.tabNot.setState(i)}}),s.dlgLog=new t.DlgSchedLog(s.subId("dlgsl")),s}return __extends(a,i),a.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var e=i.fpFilter.checkMandatory(!0,!0,!1)
if(e)return void WUX.showWarning("Specificare i seguenti campi: "+e)
var a=WUX.getComponent("boxFilter")
a instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),a.collapse()),i.selId=null,i.find()}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.clearDet(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addComponent(t.ISched.sID_SERVIZIO,"Servizio",new t.LJSASelServizi),this.fpFilter.addTextField(t.ISched.sID_ATTIVITA,"Attivita'"),this.fpFilter.addComponent(t.ISched.sSTATO,"Stato",new t.LJSASelStati),this.fpFilter.addRow(),this.fpFilter.addTextField(t.ISched.sID_CREDENZIALE_INS,"Cred. Ins."),this.fpFilter.addDateField(t.ISched.sINIZIO_VALIDITA,"Inizio Val."),this.fpFilter.addDateField(t.ISched.sFINE_VALIDITA,"Fine Val."),this.selSerDet=new t.LJSASelServizi,this.selAttDet=new t.LJSASelAttivita,this.selSerDet.on("statechange",function(t){i.selAttDet.service=i.selSerDet.getState()}),this.selAttDet.on("statechange",function(a){if(i.status==i.iSTATUS_EDITING&&i.isNew){var s=i.selAttDet.getState()
if(s){var n=i.selSerDet.getState()
jrpc.execute("SCHEDULAZIONI.readInfoAttivita",[n,s],function(a){i.tabCon.setState(e.getArray(a,t.ISched.sCONFIGURAZIONE)),i.tabPar.setState(e.getArray(a,t.ISched.sPARAMETRI)),i.tabNot.setState(e.getArray(a,t.ISched.sNOTIFICA))})}else i.tabCon.setState([]),i.tabPar.setState([]),i.tabNot.setState([])}}),this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addComponent(t.ISched.sID_SERVIZIO,"Servizio",this.selSerDet),this.fpDetail.addComponent(t.ISched.sID_ATTIVITA,"Attivita'",this.selAttDet),this.fpDetail.addRow(),this.fpDetail.addTextField(t.ISched.sDESCRIZIONE,"Descrizione"),this.fpDetail.addTextField(t.ISched.sSCHEDULAZIONE,"Schedulazione"),this.fpDetail.addRow(),this.fpDetail.addDateField(t.ISched.sINIZIO_VALIDITA,"Inizio Val."),this.fpDetail.addDateField(t.ISched.sFINE_VALIDITA,"Fine Val."),this.fpDetail.addInternalField(t.ISched.sID),this.fpDetail.addInternalField(t.ISched.sSTATO),this.fpDetail.addInternalField(t.ISched.sID_CREDENZIALE_INS),this.fpDetail.addInternalField(t.ISched.sDATA_INS),this.fpDetail.addInternalField(t.ISched.sORA_INS),this.fpDetail.addInternalField(t.ISched.sESEC_COMPLETATE),this.fpDetail.addInternalField(t.ISched.sESEC_INTERROTTE),this.fpDetail.enabled=!1,this.fpDetail.setMandatory(t.ISched.sID_SERVIZIO,t.ISched.sID_ATTIVITA,t.ISched.sDESCRIZIONE,t.ISched.sSCHEDULAZIONE),this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.enableDet(!0),i.clearDet(),i.selSerDet.setState(t._defService),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(e){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var a=i.tabResult.getSelectedRows()
if(!a||!a.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.enableDet(!0),i.fpDetail.setEnabled(t.IAtt.sID_SERVIZIO,!1),i.fpDetail.setEnabled(t.IAtt.sID_ATTIVITA,!1),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var a=i.fpDetail.checkMandatory(!0)
if(a)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+a)
var s=i.fpDetail.getState()
s[t.ISched.sCONFIGURAZIONE]=i.tabCon.getState(),s[t.ISched.sPARAMETRI]=i.tabPar.getState(),s[t.ISched.sNOTIFICA]=i.tabNot.getState(),t.putUserLog(s),i.isNew?jrpc.execute("SCHEDULAZIONI.insert",[s],function(e){i.status=i.iSTATUS_VIEW,i.enableDet(!1),i.selId=e[t.ISched.sID],i.find()}):jrpc.execute("SCHEDULAZIONI.update",[s],function(e){i.status=i.iSTATUS_VIEW,i.enableDet(!1),i.selId=e[t.ISched.sID]
var a=i.tabResult.getSelectedRows()
if(a&&a.length){var s=a[0]
i.tabResult.getState()[s]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([s])},100)}else i.find()})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.clearDet():i.onSelect(),i.status=i.iSTATUS_VIEW,i.enableDet(!1),i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(a){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.tabResult.getSelectedRowsData()
if(s&&s.length){var n=e.getString(s[0],t.ISched.sID_SERVIZIO),o=e.getNumber(s[0],t.ISched.sID),l=t.getUserLogged().userName
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("SCHEDULAZIONI.delete",[n,o,l],function(t){i.find()})})}}),this.btnToggle=new WUX.WButton(this.subId("bt"),"Abilita",WUX.WIcon.THUMBS_O_UP,WUX.BTN.ACT_OUTLINE_DANGER),this.btnToggle.on("click",function(a){i.btnToggle.blur()
var s=i.tabResult.getSelectedRowsData()
if(!s||!s.length)return void WUX.showWarning("Selezione l'elemento da abilitare/disabilitare")
var n=e.getString(s[0],t.ISched.sID_SERVIZIO),o=e.getNumber(s[0],t.ISched.sID),l=e.getString(s[0],t.ISched.sSTATO),d="D"==l,r=t.getUserLogged().userName
i.selId=o,jrpc.execute("SCHEDULAZIONI.setEnabled",[n,o,d,r],function(e){var a=i.tabResult.getSelectedRows()
if(a&&a.length){var s=i.tabResult.getState(),n=a[0]
d?(s[n][t.ISched.sSTATO]="A",i.btnToggle.setText("Disabilita",WUX.WIcon.THUMBS_O_DOWN),i.btnToggle.setText("Disabilita",WUX.WIcon.THUMBS_O_DOWN)):(s[n][t.ISched.sSTATO]="D",i.btnToggle.setText("Abilita",WUX.WIcon.THUMBS_O_UP),i.btnToggle.setText("Abilita",WUX.WIcon.THUMBS_O_UP)),i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([n])},100)}else i.find()})}),this.btnLog=new WUX.WButton(this.subId("bl"),t.TXT.VIEW,t.ICO.VIEW,WUX.BTN.ACT_OUTLINE_INFO),this.btnLog.on("click",function(a){i.btnLog.blur()
var s=i.tabResult.getSelectedRowsData()
if(!s||!s.length)return void WUX.showWarning("Selezione una schedulazione")
var n=e.getNumber(s[0],t.ISched.sID)
jrpc.execute("SCHEDULAZIONI.readLog",[n,100],function(t){if(!t||!t.length)return void WUX.showWarning("Non vi sono log per la schedulazione "+n)
i.dlgLog.setProps(n),i.dlgLog.setState(t),i.dlgLog.show(i)})})
var a=[["Id",t.ISched.sID],["Servizio",t.ISched.sID_SERVIZIO],["Attivita'",t.ISched.sID_ATTIVITA],["Schedulazione",t.ISched.sSCHEDULAZIONE],["Stato",t.ISched.sSTATO],["Descrizione",t.ISched.sDESCRIZIONE],["Esec. Compl.",t.ISched.sESEC_COMPLETATE],["Esec. Int.",t.ISched.sESEC_INTERROTTE],["Id Cred. Ins.",t.ISched.sID_CREDENZIALE_INS],["Data Ins.",t.ISched.sDATA_INS],["Ora Ins.",t.ISched.sORA_INS],["Id Cred. Agg.",t.ISched.sID_CREDENZIALE_AGG],["Data Agg.",t.ISched.sDATA_AGG],["Ora Agg.",t.ISched.sORA_AGG]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(a,0),e.col(a,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.tabResult.onRowPrepared(function(i){if(i.data){var a=e.getString(i.data,t.ISched.sSTATO)
"D"==a?WUX.setCss(i.rowElement,WUX.CSS.ERROR):"E"==a&&WUX.setCss(i.rowElement,WUX.CSS.SUCCESS)}}),this.tabResult.onDoubleClick(function(t){i.btnLog.trigger("click")}),this.tabCon=new WUX.WDXTable(this.subId("tbc"),["Opzione","Descrizione","Valore"],[t.ISched.sCONF_OPZIONE,t.ISched.sCONF_DESCRIZIONE,t.ISched.sCONF_VALORE]),this.tabCon.selectionMode="single",this.tabCon.css({h:240}),this.tabCon.onRowPrepared(function(i){if(i.data){var a=e.getBoolean(i.data,t.ISched.sCONF_DA_ATTIVITA),s=e.getBoolean(i.data,t.ISched.sCONF_OVERWRITE)
a?s&&WUX.setCss(i.rowElement,WUX.CSS.SUCCESS):WUX.setCss(i.rowElement,WUX.CSS.WARNING)}}),this.tabCon.onDoubleClick(function(t){var e=i.tabCon.getSelectedRowsData()
e&&e.length&&(i.dlgCon.setState(e[0]),i.dlgCon.show(i))}),this.btnAddCon=new WUX.WButton(this.subId("bac"),t.TXT.ADD,"",WUX.BTN.SM_PRIMARY),this.btnAddCon.on("click",function(t){i.dlgCon.setState(null),i.dlgCon.show(i)}),this.btnRemCon=new WUX.WButton(this.subId("brc"),t.TXT.REMOVE,"",WUX.BTN.SM_DANGER),this.btnRemCon.on("click",function(t){var e=i.tabCon.getSelectedRows()
if(e&&e.length){var a=i.tabCon.getState()
a.splice(e[0],1),i.tabCon.setState(a)}}),this.tabPar=new WUX.WDXTable(this.subId("tbp"),["Parametro","Descrizione","Valore"],[t.ISched.sPAR_PARAMETRO,t.ISched.sPAR_DESCRIZIONE,t.ISched.sPAR_VALORE]),this.tabPar.selectionMode="single",this.tabPar.css({h:240}),this.tabPar.onRowPrepared(function(i){if(i.data){var a=e.getBoolean(i.data,t.ISched.sPAR_DA_ATTIVITA),s=e.getBoolean(i.data,t.ISched.sPAR_OVERWRITE)
a?s&&WUX.setCss(i.rowElement,WUX.CSS.SUCCESS):WUX.setCss(i.rowElement,WUX.CSS.WARNING)}}),this.tabPar.onDoubleClick(function(t){var e=i.tabPar.getSelectedRowsData()
e&&e.length&&(i.dlgPar.setState(e[0]),i.dlgPar.show(i))}),this.btnAddPar=new WUX.WButton(this.subId("bap"),t.TXT.ADD,"",WUX.BTN.SM_PRIMARY),this.btnAddPar.on("click",function(t){i.dlgPar.setState(null),i.dlgPar.show(i)}),this.btnRemPar=new WUX.WButton(this.subId("brp"),t.TXT.REMOVE,"",WUX.BTN.SM_DANGER),this.btnRemPar.on("click",function(t){var e=i.tabPar.getSelectedRows()
if(e&&e.length){var a=i.tabPar.getState()
a.splice(e[0],1),i.tabPar.setState(a)}}),this.tabNot=new WUX.WDXTable(this.subId("tbn"),["Evento","Destinazione"],[t.ISched.sNOT_EVENTO,t.ISched.sNOT_DESTINAZIONE]),this.tabNot.selectionMode="single",this.tabNot.css({h:240}),this.tabNot.onDoubleClick(function(t){var e=i.tabPar.getSelectedRowsData()
e&&e.length&&(i.dlgNot.setState(e[0]),i.dlgNot.show(i))}),this.btnAddNot=new WUX.WButton(this.subId("ban"),t.TXT.ADD,"",WUX.BTN.SM_PRIMARY),this.btnAddNot.on("click",function(t){i.dlgNot.setState(null),i.dlgNot.show(i)}),this.btnRemNot=new WUX.WButton(this.subId("brn"),t.TXT.REMOVE,"",WUX.BTN.SM_DANGER),this.btnRemNot.on("click",function(t){var e=i.tabNot.getSelectedRows()
if(e&&e.length){var a=i.tabNot.getState()
a.splice(e[0],1),i.tabNot.setState(a)}}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.left.add(this.btnToggle),this.cntActions.left.add(this.btnLog),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.tcoDetail.addTab("Configurazione",WUX.WIcon.WRENCH).addRow().addCol("11",{h:300}).add(this.tabCon).addCol("1",{h:300}).addStack(WUX.CSS.STACK_BTNS,this.btnAddCon,this.btnRemCon),this.tcoDetail.addTab("Parametri",WUX.WIcon.EDIT).addRow().addCol("11",{h:300}).add(this.tabPar).addCol("1",{h:300}).addStack(WUX.CSS.STACK_BTNS,this.btnAddPar,this.btnRemPar),this.tcoDetail.addTab("Notifica",WUX.WIcon.ENVELOPE_O).addRow().addCol("11",{h:300}).add(this.tabNot).addCol("1",{h:300}).addStack(WUX.CSS.STACK_BTNS,this.btnAddNot,this.btnRemNot),this.tcoDetail.on("statechange",function(t){switch(i.tcoDetail.getState()){case 0:break
case 1:i.tabCon.repaint()
break
case 2:i.tabPar.repaint()
break
case 3:i.tabNot.repaint()}}),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},a.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},a.prototype.onSelect=function(){var i=this,a=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(a){var s=e.getNumber(a,t.ISched.sID)
s&&(this.clearDet(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.enableDet(!1)),jrpc.execute("SCHEDULAZIONI.read",[s],function(a){a[t.ISched.sID_SERVIZIO]=t.getIdVal(a,t.ISched.sID_SERVIZIO),a[t.ISched.sID_ATTIVITA]=t.getIdVal(a,t.ISched.sID_ATTIVITA),i.fpDetail.setState(a),i.tabCon.setState(e.getArray(a,t.ISched.sCONFIGURAZIONE)),i.tabPar.setState(e.getArray(a,t.ISched.sPARAMETRI)),i.tabNot.setState(e.getArray(a,t.ISched.sNOTIFICA)),"D"==e.getString(a,t.ISched.sSTATO)?(i.btnToggle.setText("Abilita",WUX.WIcon.THUMBS_O_UP),i.btnToggle.setText("Abilita",WUX.WIcon.THUMBS_O_UP)):(i.btnToggle.setText("Disabilita",WUX.WIcon.THUMBS_O_DOWN),i.btnToggle.setText("Disabilita",WUX.WIcon.THUMBS_O_DOWN)),i.status=i.iSTATUS_VIEW}))}},a.prototype.clearDet=function(){this.fpDetail.clear(),this.tabCon.setState([]),this.tabPar.setState([]),this.tabNot.setState([])},a.prototype.enableDet=function(t){this.fpDetail.enabled=t,this.tabCon.enabled=t,this.tabPar.enabled=t,this.tabNot.enabled=t},a.prototype.find=function(){var i=this,a=t.getUserLogged()
jrpc.execute("SCHEDULAZIONI.find",[this.fpFilter.getState(),a.groups],function(a){if(i.tabResult.setState(a),i.clearDet(),i.status=i.iSTATUS_STARTUP,i.selId){var s=e.indexOf(a,t.ISched.sID,i.selId)
s>=0&&setTimeout(function(){i.tabResult.select([s])},100),i.selId=null}})},a}(WUX.WComponent)
t.GUISchedulazioni=i}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function a(t){var e=i.call(this,t||"*","GUIServizi")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(a,i),a.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(a){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.fpFilter.checkMandatory(!0,!0,!1)
if(s)return void WUX.showWarning("Specificare i seguenti campi: "+s)
var n=WUX.getComponent("boxFilter")
n instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),n.collapse())
var o=t.getUserLogged()
jrpc.execute("SERVIZI.find",[i.fpFilter.getState(),o.groups],function(a){if(i.tabResult.setState(a),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var s=e.indexOf(a,t.IServizio.sID_SERVIZIO,i.selId)
s>=0&&setTimeout(function(){i.tabResult.select([s])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addTextField(t.IServizio.sID_SERVIZIO,"Codice"),this.fpFilter.addTextField(t.IServizio.sDESCRIZIONE,"Descrizione"),this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addTextField(t.IServizio.sID_SERVIZIO,"Codice"),this.fpDetail.addTextField(t.IServizio.sDESCRIZIONE,"Descrizione"),this.fpDetail.enabled=!1,this.fpDetail.setMandatory(t.IServizio.sID_SERVIZIO,t.IServizio.sDESCRIZIONE),this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var a=i.fpDetail.checkMandatory(!0)
if(a)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+a)
var s=i.fpDetail.getState()
i.isNew?jrpc.execute("SERVIZI.insert",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IServizio.sID_SERVIZIO],i.btnFind.trigger("click")}):jrpc.execute("SERVIZI.update",[s],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IServizio.sID_SERVIZIO]
var a=i.tabResult.getSelectedRows()
if(a&&a.length){var s=a[0]
i.tabResult.getState()[s]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([s])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(a){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.tabResult.getSelectedRowsData()
if(s&&s.length){var n=e.getString(s[0],t.IServizio.sID_SERVIZIO)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("SERVIZI.delete",[n],function(t){i.btnFind.trigger("click")})})}})
var a=[["Codice",t.IServizio.sID_SERVIZIO],["Descrizione",t.IServizio.sDESCRIZIONE]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(a,0),e.col(a,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},a.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},a.prototype.onSelect=function(){var i=this,a=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(a){var s=e.getString(a,t.IServizio.sID_SERVIZIO)
s&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("SERVIZI.read",[s],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},a}(WUX.WComponent)
t.GUIServizi=i}(GUI||(GUI={}))
