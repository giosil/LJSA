var GUI
!function(t){var e=WUX.WUtil,i=function(i){function s(s){var n=i.call(this,s||"*","GUIAttivita")||this
return n.iSTATUS_STARTUP=0,n.iSTATUS_VIEW=1,n.iSTATUS_EDITING=2,n.status=n.iSTATUS_STARTUP,n.dlgCon=new t.DlgAttCon(n.subId("dlgac")),n.dlgCon.onHiddenModal(function(i){if(n.dlgCon.ok){var s=n.tabResult.getState(),a=n.dlgCon.getProps(),l=n.dlgCon.getState()
if(a&&l){var o=t.indexOf(s,t.IAtt.sID_SERVIZIO,t.IAtt.sID_ATTIVITA,a)
if(o>=0){var r=s[o],d=e.getArray(r,t.IAtt.sCONFIGURAZIONE),I=e.indexOf(d,t.IAtt.sCONF_OPZIONE,l[t.IAtt.sCONF_OPZIONE])
I>=0?d[I]=l:(d.push(l),n.tabCon.refresh())}}}}),n.dlgPar=new t.DlgAttPar(n.subId("dlgap")),n.dlgPar.onHiddenModal(function(i){if(n.dlgPar.ok){var s=n.tabResult.getState(),a=n.dlgPar.getProps(),l=n.dlgPar.getState()
if(a&&l){var o=t.indexOf(s,t.IAtt.sID_SERVIZIO,t.IAtt.sID_ATTIVITA,a)
if(o>=0){var r=s[o],d=e.getArray(r,t.IAtt.sPARAMETRI),I=e.indexOf(d,t.IAtt.sPAR_PARAMETRO,l[t.IAtt.sPAR_PARAMETRO])
I>=0?d[I]=l:(d.push(l),n.tabPar.refresh())}}}}),n.dlgNot=new t.DlgAttNot(n.subId("dlgan")),n.dlgNot.onHiddenModal(function(i){if(n.dlgNot.ok){var s=n.tabResult.getState(),a=n.dlgNot.getProps(),l=n.dlgNot.getState()
if(a&&l){var o=t.indexOf(s,t.IAtt.sID_SERVIZIO,t.IAtt.sID_ATTIVITA,a)
if(o>=0){var r=s[o],d=e.getArray(r,t.IAtt.sNOTIFICA),I=t.indexOf(d,t.IAtt.sNOT_EVENTO,t.IAtt.sNOT_DESTINAZIONE,l[t.IAtt.sNOT_EVENTO]+":"+l[t.IAtt.sNOT_DESTINAZIONE])
I>=0?d[I]=l:(d.push(l),n.tabNot.refresh())}}}}),n}return __extends(s,i),s.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.fpFilter.checkMandatory(!0,!0,!1)
if(s)return void WUX.showWarning("Specificare i seguenti campi: "+s)
var n=WUX.getComponent("boxFilter")
n instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),n.collapse())
var a=t.getUserLogged()
jrpc.execute("ATTIVITA.find",[i.fpFilter.getState(),a.groups],function(e){if(i.tabResult.setState(e),i.clearDet(),i.status=i.iSTATUS_STARTUP,i.selId){var s=t.indexOf(e,t.IAtt.sID_SERVIZIO,t.IAtt.sID_ATTIVITA,i.selId)
s>=0&&setTimeout(function(){i.tabResult.select([s])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.clearDet(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addComponent(t.IAtt.sID_SERVIZIO,"Servizio",new t.LJSASelServizi),this.fpFilter.addTextField(t.IAtt.sID_ATTIVITA,"Codice"),this.fpFilter.addTextField(t.IAtt.sDESCRIZIONE,"Descrizione"),this.selSerDet=new t.LJSASelServizi,this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addComponent(t.IAtt.sID_SERVIZIO,"Servizio",this.selSerDet),this.fpDetail.addTextField(t.IAtt.sID_ATTIVITA,"Codice"),this.fpDetail.addRow(),this.fpDetail.addTextField(t.IAtt.sCLASSE,"Classe"),this.fpDetail.addTextField(t.IAtt.sDESCRIZIONE,"Descrizione"),this.fpDetail.addInternalField(t.IAtt.sID_CREDENZIALE_INS),this.fpDetail.addInternalField(t.IAtt.sDATA_INS),this.fpDetail.addInternalField(t.IAtt.sORA_INS),this.fpDetail.enabled=!1,this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.enableDet(!0),i.fpDetail.clear(),i.selSerDet.setState(t._defService),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.enableDet(!0),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var s=i.fpDetail.checkMandatory(!0)
if(s)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+s)
var n=i.fpDetail.getState()
i.isNew?jrpc.execute("ATTIVITA.insert",[n],function(e){i.status=i.iSTATUS_VIEW,i.enableDet(!1),i.selId=e[t.IAtt.sID_SERVIZIO]+":"+e[t.IAtt.sID_ATTIVITA],i.btnFind.trigger("click")}):jrpc.execute("ATTIVITA.update",[n],function(e){i.status=i.iSTATUS_VIEW,i.enableDet(!1),i.selId=e[t.IAtt.sID_SERVIZIO]+":"+e[t.IAtt.sID_ATTIVITA]
var s=i.tabResult.getSelectedRows()
if(s&&s.length){var n=s[0]
i.tabResult.getState()[n]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([n])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.clearDet():i.onSelect(),i.status=i.iSTATUS_VIEW,i.enableDet(!1),i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(s){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var n=i.tabResult.getSelectedRowsData()
if(n&&n.length){var a=e.getString(n[0],t.IAtt.sID_SERVIZIO),l=e.getString(n[0],t.IAtt.sID_ATTIVITA)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("ATTIVITA.delete",[a,l],function(t){i.btnFind.trigger("click")})})}})
var s=[["Servizio",t.IAtt.sID_SERVIZIO],["Codice",t.IAtt.sID_ATTIVITA],["Descrizione",t.IAtt.sDESCRIZIONE],["Classe",t.IAtt.sCLASSE],["Id Cred. Ins.",t.IAtt.sID_CREDENZIALE_INS],["Data Ins.",t.IAtt.sDATA_INS],["Ora Ins.",t.IAtt.sORA_INS],["Id Cred. Agg.",t.IAtt.sID_CREDENZIALE_AGG],["Data Agg.",t.IAtt.sDATA_AGG],["Ora Agg.",t.IAtt.sORA_AGG]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(s,0),e.col(s,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.tabCon=new WUX.WDXTable(this.subId("tbc"),["Opzione","Descrizione","Valori","Predefinito"],[t.IAtt.sCONF_OPZIONE,t.IAtt.sCONF_DESCRIZIONE,t.IAtt.sCONF_VALORI,t.IAtt.sCONF_PREDEFINITO]),this.tabCon.selectionMode="single",this.tabCon.css({h:250}),this.tabCon.widths=[120,120],this.tabCon.onDoubleClick(function(t){var e=i.tabCon.getSelectedRowsData()
e&&e.length&&(i.dlgCon.setProps(i.selId),i.dlgCon.setState(e[0]),i.dlgCon.show(i))}),this.btnAddCon=new WUX.WButton(this.subId("bac"),t.TXT.ADD,"",WUX.BTN.SM_PRIMARY),this.btnAddCon.on("click",function(t){i.dlgCon.setProps(i.selId),i.dlgCon.setState(null),i.dlgCon.show(i)}),this.btnRemCon=new WUX.WButton(this.subId("brc"),t.TXT.REMOVE,"",WUX.BTN.SM_DANGER),this.btnRemCon.on("click",function(t){}),this.tabPar=new WUX.WDXTable(this.subId("tbp"),["Parametro","Descrizione","Valori","Predefinito"],[t.IAtt.sPAR_PARAMETRO,t.IAtt.sPAR_DESCRIZIONE,t.IAtt.sPAR_VALORI,t.IAtt.sPAR_PREDEFINITO]),this.tabPar.selectionMode="single",this.tabPar.css({h:250}),this.tabPar.widths=[120,120],this.tabPar.onDoubleClick(function(t){var e=i.tabPar.getSelectedRowsData()
e&&e.length&&(i.dlgPar.setProps(i.selId),i.dlgPar.setState(e[0]),i.dlgPar.show(i))}),this.btnAddPar=new WUX.WButton(this.subId("bap"),t.TXT.ADD,"",WUX.BTN.SM_PRIMARY),this.btnAddPar.on("click",function(t){i.dlgPar.setProps(i.selId),i.dlgPar.setState(null),i.dlgPar.show(i)}),this.btnRemPar=new WUX.WButton(this.subId("brp"),t.TXT.REMOVE,"",WUX.BTN.SM_DANGER),this.btnRemPar.on("click",function(t){}),this.tabNot=new WUX.WDXTable(this.subId("tbn"),["Evento","Destinazione"],[t.IAtt.sNOT_EVENTO,t.IAtt.sNOT_DESTINAZIONE]),this.tabNot.selectionMode="single",this.tabNot.css({h:250}),this.tabNot.widths=[120,120],this.tabNot.onDoubleClick(function(t){var e=i.tabPar.getSelectedRowsData()
e&&e.length&&(i.dlgNot.setProps(i.selId),i.dlgNot.setState(e[0]),i.dlgNot.show(i))}),this.btnAddNot=new WUX.WButton(this.subId("ban"),t.TXT.ADD,"",WUX.BTN.SM_PRIMARY),this.btnAddNot.on("click",function(t){i.dlgNot.setProps(i.selId),i.dlgNot.setState(null),i.dlgNot.show(i)}),this.btnRemNot=new WUX.WButton(this.subId("brn"),t.TXT.REMOVE,"",WUX.BTN.SM_DANGER),this.btnRemNot.on("click",function(t){}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.tcoDetail.addTab("Configurazione",WUX.WIcon.WRENCH).addRow().addCol("11",{h:300}).add(this.tabCon).addCol("1",{h:300}).addStack(WUX.CSS.STACK_BTNS,this.btnAddCon,this.btnRemCon),this.tcoDetail.addTab("Parametri",WUX.WIcon.EDIT).addRow().addCol("11",{h:300}).add(this.tabPar).addCol("1",{h:300}).addStack(WUX.CSS.STACK_BTNS,this.btnAddPar,this.btnRemPar),this.tcoDetail.addTab("Notifica",WUX.WIcon.ENVELOPE_O).addRow().addCol("11",{h:300}).add(this.tabNot).addCol("1",{h:300}).addStack(WUX.CSS.STACK_BTNS,this.btnAddNot,this.btnRemNot),this.tcoDetail.on("statechange",function(t){switch(i.tcoDetail.getState()){case 0:break
case 1:i.tabCon.repaint()
break
case 2:i.tabPar.repaint()
break
case 3:i.tabNot.repaint()}}),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},s.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},s.prototype.onSelect=function(){var i=this,s=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(s){var n=e.getString(s,t.IAtt.sID_SERVIZIO),a=e.getString(s,t.IAtt.sID_ATTIVITA)
n&&a&&(this.clearDet(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.enableDet(!1)),jrpc.execute("ATTIVITA.read",[n,a],function(s){i.fpDetail.setState(s),i.tabCon.setState(e.getArray(s,t.IAtt.sCONFIGURAZIONE)),i.tabPar.setState(e.getArray(s,t.IAtt.sPARAMETRI)),i.tabNot.setState(e.getArray(s,t.IAtt.sNOTIFICA)),i.status=i.iSTATUS_VIEW}))}},s.prototype.clearDet=function(){this.fpDetail.clear(),this.tabCon.setState([]),this.tabPar.setState([]),this.tabNot.setState([])},s.prototype.enableDet=function(t){this.fpDetail.enabled=t,this.tabCon.enabled=t,this.tabPar.enabled=t,this.tabNot.enabled=t},s}(WUX.WComponent)
t.GUIAttivita=i}(GUI||(GUI={}))
var GUI
!function(t){function e(){var e=window?window._userLogged:void 0
return e&&"object"==typeof e?e:{id:1,userName:"dew",currLogin:new Date,role:"admin",groups:[t.LJSA_SERVICE],structures:[],email:"test@dew.org",mobile:"3491234567",tokenId:"KURJPghMTJ"}}function i(){var t=window?window._config:void 0
return t&&"object"==typeof t?t:{}}function s(){var t=e()
return null!=t&&t.locale?t.locale:WUX.WUtil.getString(i(),"locale","")}function n(){var t=window?window._userLogged:void 0
return!t||"object"!=typeof t}function a(t,e,i,s){if(!t||!e||!i)return-1
for(var n=l.toArray(t),a=0;a<n.length;a++){if(l.getValue(n[a],e)+":"+l.getValue(n[a],i)==s)return a}return-1}var l=WUX.WUtil
t.LJSA_SERVICE="LJSA",t._defService="",t.getUserLogged=e,t.getConfig=i,t.getLocale=s,t.isDevMode=n,t.indexOf=a
var o=function(){function t(){}return t.sID_SERVIZIO="id_servizio",t.sDESCRIZIONE="descrizione",t.sATTIVO="attivo",t.sCREDENZIALI="credenziali",t}()
t.IServizio=o
var r=function(){function t(){}return t.sCLASSE="classe",t.sDESCRIZIONE="descrizione",t.sATTIVITA="attivita",t}()
t.IClasse=r
var d=function(){function t(){}return t.sID_SERVIZIO="id_servizio",t.sID_CREDENZIALE="id_credenziale",t.sCREDENZIALI="credenziali",t.sEMAIL="email",t.sATTIVO="attivo",t}()
t.ICredenziale=d
var I=function(){function t(){}return t.sID_SERVIZIO="id_servizio",t.sID_ATTIVITA="id_attivita",t.sDESCRIZIONE="descrizione",t.sCLASSE="classe",t.sATTIVO="attivo",t.sID_CREDENZIALE_INS="id_credenziale_ins",t.sDATA_INS="data_inserimento",t.sORA_INS="ora_inserimento",t.sID_CREDENZIALE_AGG="id_credenziale_agg",t.sDATA_AGG="data_aggiornamento",t.sORA_AGG="ora_aggiornamento",t.sCONFIGURAZIONE="configurazione",t.sCONF_OPZIONE="opzione",t.sCONF_DESCRIZIONE="descrizione",t.sCONF_VALORI="valori",t.sCONF_PREDEFINITO="predefinito",t.sPARAMETRI="parametri",t.sPAR_PARAMETRO="parametro",t.sPAR_DESCRIZIONE="descrizione",t.sPAR_VALORI="valori",t.sPAR_PREDEFINITO="predefinito",t.sNOTIFICA="notifica",t.sNOT_EVENTO="evento",t.sNOT_DESTINAZIONE="destinazione",t}()
t.IAtt=I
var c=function(){function t(){}return t.sID_SCHEDULAZIONE="id_schedulazione",t.sID_SERVIZIO="id_servizio",t.sID_ATTIVITA="id_attivita",t.sSCHEDULAZIONE="schedulazione",t.sDESCRIZIONE="descrizione",t.sID_CREDENZIALE_INS="id_credenziale_ins",t.sDATA_INS="data_inserimento",t.sORA_INS="ora_inserimento",t.sID_CREDENZIALE_AGG="id_credenziale_agg",t.sDATA_AGG="data_aggiornamento",t.sORA_AGG="ora_aggiornamento",t.sSTATO="stato",t.sINIZIO_VALIDITA="inizio_validita",t.sFINE_VALIDITA="fine_validita",t.sDATA_SCHED="data_schedulazione",t.sORA_SCHED="ora_schedulazione",t.sATTIVO="a",t.sPARAMETRI="parametri",t.sPAR_PARAMETRO="parametro",t.sPAR_VALORE="valore",t.sPAR_DA_ATTIVITA="da_attivita",t.sPAR_OVERWRITE="overwrite",t.sPAR_DESCRIZIONE=I.sPAR_DESCRIZIONE,t.sPAR_VALORI=I.sPAR_VALORI,t.sPAR_PREDEFINITO=I.sPAR_PREDEFINITO,t.sCONFIGURAZIONE="configurazione",t.sCONF_OPZIONE="opzione",t.sCONF_VALORE="valore",t.sCONF_DA_ATTIVITA="da_attivita",t.sCONF_OVERWRITE="overwrite",t.sCONF_DESCRIZIONE=I.sCONF_DESCRIZIONE,t.sCONF_VALORI=I.sCONF_VALORI,t.sCONF_PREDEFINITO=I.sCONF_PREDEFINITO,t.sCONF_TIMEOUT="timeout",t.sCONF_STOP_ON_TIMEOUT="stopOnTimeout",t.sCONF_COMPRESS_FILES="compressFiles",t.sCONF_ATTACH_FILES="attachFiles",t.sCONF_ATTACH_ERR_FILES="attachErrorFiles",t.sCONF_FILE_INFO="fileInfo",t.sCONF_NO_LOG="nolog",t.sNOTIFICA="notifica",t.sNOT_EVENTO="evento",t.sNOT_DESTINAZIONE="destinazione",t.sNOT_DA_ATTIVITA="da_attivita",t.sNOT_CANCELLATA="cancellata",t.sESEC_COMPLETATE="esecuzioni_completate",t.sESEC_INTERROTTE="esecuzioni_interrotte",t}()
t.ISched=c}(GUI||(GUI={})),WUX.global.locale=GUI.getLocale()
var jrpc=new JRPC("/LJSA/rpc")
jrpc.setUserName(GUI.getUserLogged().userName),jrpc.setPassword(GUI.getUserLogged().tokenId)
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function s(t){var e=i.call(this,t||"*","GUIClassi")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(s,i),s.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(s){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var n=i.fpFilter.checkMandatory(!0,!0,!1)
if(n)return void WUX.showWarning("Specificare i seguenti campi: "+n)
var a=WUX.getComponent("boxFilter")
a instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),a.collapse()),jrpc.execute("CLASSI.find",[i.fpFilter.getState()],function(s){if(i.tabResult.setState(s),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var n=e.indexOf(s,t.IClasse.sCLASSE,i.selId)
n>=0&&setTimeout(function(){i.tabResult.select([n])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addTextField(t.IClasse.sCLASSE,"Classe"),this.fpFilter.addTextField(t.IClasse.sDESCRIZIONE,"Descrizione"),this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addTextField(t.IClasse.sCLASSE,"Classe"),this.fpDetail.addTextField(t.IClasse.sDESCRIZIONE,"Descrizione"),this.fpDetail.enabled=!1,this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var s=i.fpDetail.checkMandatory(!0)
if(s)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+s)
var n=i.fpDetail.getState()
i.isNew?jrpc.execute("CLASSI.insert",[n],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IClasse.sCLASSE],i.btnFind.trigger("click")}):jrpc.execute("CLASSI.update",[n],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IClasse.sCLASSE]
var s=i.tabResult.getSelectedRows()
if(s&&s.length){var n=s[0]
i.tabResult.getState()[n]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([n])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(s){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var n=i.tabResult.getSelectedRowsData()
if(n&&n.length){var a=e.getString(n[0],t.IClasse.sCLASSE)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("CLASSI.delete",[a],function(t){i.btnFind.trigger("click")})})}})
var s=[["Classe",t.IClasse.sCLASSE],["Descrizione",t.IClasse.sDESCRIZIONE]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(s,0),e.col(s,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},s.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},s.prototype.onSelect=function(){var i=this,s=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(s){var n=e.getString(s,t.IClasse.sCLASSE)
n&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("CLASSI.read",[n],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},s}(WUX.WComponent)
t.GUIClassi=i}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(t){function e(e){var i=t.call(this,e,"AppTableActions",null,"table-actions-wrapper")||this
return i.left=new WUX.WContainer(i.subId("l"),"left-actions"),i.right=new WUX.WContainer(i.subId("r"),"right-actions"),i}return __extends(e,t),e.prototype.componentDidMount=function(){var t=$('<div class="table-actions clearfix" data-b2x-sticky-element="1" data-b2x-sticky-element-z-index="3"></div>')
this.root.append(t),this.left.mount(t),this.right.mount(t)},e.prototype.setLeftVisible=function(t){this.left.visible=t},e.prototype.setRightVisible=function(t){this.right.visible=t},e}(WUX.WComponent)
t.AppTableActions=i
var s=function(i){function s(t,e){var s=i.call(this,t)||this
return s.multiple=e,s.name="LJSASelServizi",s}return __extends(s,i),s.prototype.updateState=function(s){i.prototype.updateState.call(this,s)
var n=e.toString(s)
n||(t._defService=n)},s.prototype.componentDidMount=function(){var e=this,i=t.getUserLogged()
jrpc.execute("SERVIZI.lookup",[i.groups],function(t){for(var i=[],s=0;s<t.length;s++){var n=t[s],a={id:n[0],text:n[2]}
i.push(a)}var l={data:i,placeholder:"",allowClear:!0}
e.init(l)})},s}(WUX.WSelect2)
t.LJSASelServizi=s
var n=function(t){function e(e,i){var s=t.call(this,e,[],i)||this
return s.name="LJSASelClassi",s}return __extends(e,t),e.prototype.componentDidMount=function(){var t={ajax:{dataType:"json",delay:400,processResults:function(t,e){return{results:t}},transport:function(t,e,i){jrpc.execute("CLASSI.lookup",[t.data],e)}},placeholder:"",allowClear:!0,minimumInputLength:3}
this.init(t)},e}(WUX.WSelect2)
t.LJSASelClassi=n
var a=function(e){function i(t,i){var s=e.call(this,t,[],i)||this
return s.name="LJSASelAttivita",s}return __extends(i,e),i.prototype.componentDidMount=function(){var e={ajax:{dataType:"json",delay:400,processResults:function(t,e){return{results:t}},transport:function(e,i,s){jrpc.execute("ATTIVITA.lookup",[t._defService,e.data],i)}},placeholder:"",allowClear:!0,minimumInputLength:3}
this.init(e)},i}(WUX.WSelect2)
t.LJSASelAttivita=a
var l=function(t){function e(e,i){var s=t.call(this,e)||this
return s.multiple=i,s.name="LJSASelStati",s.options=[{id:"",text:""},{id:"A",text:"(A) Attiva"},{id:"D",text:"(D) Disattivata"},{id:"E",text:"(E) In Esecuzione"}],s}return __extends(e,t),e}(WUX.WSelect2)
t.LJSASelStati=l
var o=function(t){function e(e,i){var s=t.call(this,e)||this
return s.multiple=i,s.name="LJSASelStati",s.options=[{id:"",text:""},{id:"R",text:"(R) Risultato elaborazione"},{id:"E",text:"(E) Eccezione verificatasi"},{id:"T",text:"(T) Timeout raggiunto"}],s}return __extends(e,t),e}(WUX.WSelect2)
t.LJSASelEventi=o}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function s(t){var e=i.call(this,t||"*","GUICredenziali")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(s,i),s.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var s=i.fpFilter.checkMandatory(!0,!0,!1)
if(s)return void WUX.showWarning("Specificare i seguenti campi: "+s)
var n=WUX.getComponent("boxFilter")
n instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),n.collapse())
var a=t.getUserLogged()
jrpc.execute("CREDENZIALI.find",[i.fpFilter.getState(),a.groups],function(e){if(i.tabResult.setState(e),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var s=t.indexOf(e,t.ICredenziale.sID_SERVIZIO,t.ICredenziale.sID_CREDENZIALE,i.selId)
s>=0&&setTimeout(function(){i.tabResult.select([s])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addComponent(t.ICredenziale.sID_SERVIZIO,"Servizio",new t.LJSASelServizi),this.fpFilter.addTextField(t.ICredenziale.sID_CREDENZIALE,"Credenziale"),this.fpFilter.addTextField(t.ICredenziale.sEMAIL,"Email"),this.selSerDet=new t.LJSASelServizi,this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addComponent(t.ICredenziale.sID_SERVIZIO,"Servizio",this.selSerDet),this.fpDetail.addTextField(t.ICredenziale.sID_CREDENZIALE,"Credenziale"),this.fpDetail.addRow(),this.fpDetail.addPasswordField(t.ICredenziale.sCREDENZIALI,"Password"),this.fpDetail.addTextField(t.ICredenziale.sEMAIL,"Email"),this.fpDetail.enabled=!1,this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),i.selSerDet.setState(t._defService),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var s=i.fpDetail.checkMandatory(!0)
if(s)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+s)
var n=i.fpDetail.getState()
i.isNew?jrpc.execute("CREDENZIALI.insert",[n],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.ICredenziale.sID_SERVIZIO]+":"+e[t.ICredenziale.sID_CREDENZIALE],i.btnFind.trigger("click")}):jrpc.execute("CREDENZIALI.update",[n],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.ICredenziale.sID_SERVIZIO]+":"+e[t.ICredenziale.sID_CREDENZIALE]
var s=i.tabResult.getSelectedRows()
if(s&&s.length){var n=s[0]
i.tabResult.getState()[n]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([n])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(s){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var n=i.tabResult.getSelectedRowsData()
if(n&&n.length){var a=e.getString(n[0],t.ICredenziale.sID_SERVIZIO),l=e.getString(n[0],t.ICredenziale.sID_CREDENZIALE)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("CREDENZIALI.delete",[a,l],function(t){i.btnFind.trigger("click")})})}})
var s=[["Servizio",t.ICredenziale.sID_SERVIZIO],["Credenziale",t.ICredenziale.sID_CREDENZIALE],["Email",t.ICredenziale.sEMAIL]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(s,0),e.col(s,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},s.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},s.prototype.onSelect=function(){var i=this,s=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(s){var n=e.getString(s,t.ICredenziale.sID_SERVIZIO),a=e.getString(s,t.ICredenziale.sID_CREDENZIALE)
n&&a&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("CREDENZIALI.read",[n,a],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},s}(WUX.WComponent)
t.GUICredenziali=i}(GUI||(GUI={}))
var GUI
!function(t){var e=function(e){function i(i){var s=e.call(this,i,"DlgAttCon")||this
return s.title="Configurazione",s.fp=new WUX.WFormPanel(s.subId("fp")),s.fp.addRow(),s.fp.addTextField(t.IAtt.sCONF_OPZIONE,"Opzione"),s.fp.addRow(),s.fp.addTextField(t.IAtt.sCONF_DESCRIZIONE,"Descrizione"),s.fp.addRow(),s.fp.addTextField(t.IAtt.sCONF_VALORI,"Valori"),s.fp.addRow(),s.fp.addTextField(t.IAtt.sCONF_PREDEFINITO,"Predefinito"),s.fp.setMandatory(t.IAtt.sCONF_OPZIONE,t.IAtt.sCONF_DESCRIZIONE),s.body.addRow().addCol("12").add(s.fp),s}return __extends(i,e),i.prototype.updateState=function(t){e.prototype.updateState.call(this,t),this.fp&&this.fp.setState(this.state)},i.prototype.getState=function(){return this.fp&&(this.state=this.fp.getState()),this.state},i.prototype.onClickOk=function(){var t=this.fp.checkMandatory(!0)
return!t||(WUX.showWarning("Specificare: "+t),!1)},i}(WUX.WDialog)
t.DlgAttCon=e
var i=function(e){function i(i){var s=e.call(this,i,"DlgAttPar")||this
return s.title="Parametro",s.fp=new WUX.WFormPanel(s.subId("fp")),s.fp.addRow(),s.fp.addTextField(t.IAtt.sPAR_PARAMETRO,"Parametro"),s.fp.addRow(),s.fp.addTextField(t.IAtt.sPAR_DESCRIZIONE,"Descrizione"),s.fp.addRow(),s.fp.addTextField(t.IAtt.sPAR_VALORI,"Valori"),s.fp.addRow(),s.fp.addTextField(t.IAtt.sPAR_PREDEFINITO,"Predefinito"),s.fp.setMandatory(t.IAtt.sPAR_PARAMETRO,t.IAtt.sPAR_DESCRIZIONE),s.body.addRow().addCol("12").add(s.fp),s}return __extends(i,e),i.prototype.updateState=function(t){e.prototype.updateState.call(this,t),this.fp&&this.fp.setState(this.state)},i.prototype.getState=function(){return this.fp&&(this.state=this.fp.getState()),this.state},i.prototype.onClickOk=function(){var t=this.fp.checkMandatory(!0)
return!t||(WUX.showWarning("Specificare: "+t),!1)},i}(WUX.WDialog)
t.DlgAttPar=i
var s=function(e){function i(i){var s=e.call(this,i,"DlgAttNot")||this
return s.title="Notifica",s.fp=new WUX.WFormPanel(s.subId("fp")),s.fp.addRow(),s.fp.addComponent(t.IAtt.sNOT_EVENTO,"Evento",new t.LJSASelEventi),s.fp.addRow(),s.fp.addTextField(t.IAtt.sNOT_DESTINAZIONE,"Destinazione"),s.fp.setMandatory(t.IAtt.sNOT_EVENTO,t.IAtt.sNOT_DESTINAZIONE),s.body.addRow().addCol("12").add(s.fp),s}return __extends(i,e),i.prototype.updateState=function(t){e.prototype.updateState.call(this,t),this.fp&&this.fp.setState(this.state)},i.prototype.getState=function(){return this.fp&&(this.state=this.fp.getState()),this.state},i.prototype.onClickOk=function(){var t=this.fp.checkMandatory(!0)
return!t||(WUX.showWarning("Specificare: "+t),!1)},i}(WUX.WDialog)
t.DlgAttNot=s}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function s(t){var e=i.call(this,t||"*","GUISchedulazioni")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(s,i),s.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(s){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var n=i.fpFilter.checkMandatory(!0,!0,!1)
if(n)return void WUX.showWarning("Specificare i seguenti campi: "+n)
var a=WUX.getComponent("boxFilter")
a instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),a.collapse())
var l=t.getUserLogged()
jrpc.execute("SCHEDULAZIONI.find",[i.fpFilter.getState(),l.groups],function(s){if(i.tabResult.setState(s),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var n=e.indexOf(s,t.ISched.sID_SCHEDULAZIONE,i.selId)
n>=0&&setTimeout(function(){i.tabResult.select([n])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addComponent(t.ISched.sID_SERVIZIO,"Servizio",new t.LJSASelServizi),this.fpFilter.addTextField(t.ISched.sID_ATTIVITA,"Attivita'"),this.fpFilter.addComponent(t.ISched.sSTATO,"Stato",new t.LJSASelStati),this.fpFilter.addRow(),this.fpFilter.addTextField(t.ISched.sID_CREDENZIALE_INS,"Cred. Ins."),this.fpFilter.addDateField(t.ISched.sINIZIO_VALIDITA,"Inizio Val."),this.fpFilter.addDateField(t.ISched.sFINE_VALIDITA,"Fine Val."),this.selSerDet=new t.LJSASelServizi,this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addComponent(t.ISched.sID_SERVIZIO,"Servizio",this.selSerDet),this.fpDetail.addTextField(t.ISched.sID_ATTIVITA,"Attivita'"),this.fpDetail.addRow(),this.fpDetail.addTextField(t.ISched.sDESCRIZIONE,"Descrizione"),this.fpDetail.addTextField(t.ISched.sSCHEDULAZIONE,"Schedulazione"),this.fpDetail.addRow(),this.fpDetail.addDateField(t.ISched.sINIZIO_VALIDITA,"Inizio Val."),this.fpDetail.addDateField(t.ISched.sFINE_VALIDITA,"Fine Val."),this.fpDetail.addInternalField(t.ISched.sID_SCHEDULAZIONE),this.fpDetail.addInternalField(t.ISched.sSTATO),this.fpDetail.addInternalField(t.ISched.sID_CREDENZIALE_INS),this.fpDetail.addInternalField(t.ISched.sDATA_INS),this.fpDetail.addInternalField(t.ISched.sORA_INS),this.fpDetail.addInternalField(t.ISched.sESEC_COMPLETATE),this.fpDetail.addInternalField(t.ISched.sESEC_INTERROTTE),this.fpDetail.enabled=!1,this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(e){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),i.selSerDet.setState(t._defService),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var s=i.fpDetail.checkMandatory(!0)
if(s)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+s)
var n=i.fpDetail.getState()
i.isNew?jrpc.execute("SCHEDULAZIONI.insert",[n],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.ISched.sID_SCHEDULAZIONE],i.btnFind.trigger("click")}):jrpc.execute("SCHEDULAZIONI.update",[n],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.ISched.sID_SCHEDULAZIONE]
var s=i.tabResult.getSelectedRows()
if(s&&s.length){var n=s[0]
i.tabResult.getState()[n]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([n])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(s){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var n=i.tabResult.getSelectedRowsData()
if(n&&n.length){var a=e.getString(n[0],t.ISched.sID_SERVIZIO),l=e.getNumber(n[0],t.ISched.sID_SCHEDULAZIONE),o=t.getUserLogged().userName
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("SCHEDULAZIONI.delete",[a,l,o],function(t){i.btnFind.trigger("click")})})}})
var s=[["Id",t.ISched.sID_SCHEDULAZIONE],["Servizio",t.ISched.sID_SERVIZIO],["Attivita'",t.ISched.sID_ATTIVITA],["Schedulazione",t.ISched.sSCHEDULAZIONE],["Stato",t.ISched.sSTATO],["Descrizione",t.ISched.sDESCRIZIONE],["Esec. Compl.",t.ISched.sESEC_COMPLETATE],["Esec. Int.",t.ISched.sESEC_INTERROTTE],["Id Cred. Ins.",t.ISched.sID_CREDENZIALE_INS],["Data Ins.",t.ISched.sDATA_INS],["Ora Ins.",t.ISched.sORA_INS],["Id Cred. Agg.",t.ISched.sID_CREDENZIALE_AGG],["Data Agg.",t.ISched.sDATA_AGG],["Ora Agg.",t.ISched.sORA_AGG]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(s,0),e.col(s,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.tabResult.onRowPrepared(function(i){if(i.data){var s=e.getString(i.data,t.ISched.sSTATO)
"D"==s?WUX.setCss(i.rowElement,WUX.CSS.ERROR):"E"==s&&WUX.setCss(i.rowElement,WUX.CSS.SUCCESS)}}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},s.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},s.prototype.onSelect=function(){var i=this,s=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(s){var n=e.getNumber(s,t.ISched.sID_SCHEDULAZIONE)
n&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("SCHEDULAZIONI.read",[n],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},s}(WUX.WComponent)
t.GUISchedulazioni=i}(GUI||(GUI={}))
var GUI
!function(t){var e=WUX.WUtil,i=function(i){function s(t){var e=i.call(this,t||"*","GUIServizi")||this
return e.iSTATUS_STARTUP=0,e.iSTATUS_VIEW=1,e.iSTATUS_EDITING=2,e.status=e.iSTATUS_STARTUP,e}return __extends(s,i),s.prototype.render=function(){var i=this
this.btnFind=new WUX.WButton(this.subId("bf"),t.TXT.FIND,"",WUX.BTN.SM_PRIMARY),this.btnFind.on("click",function(s){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
var n=i.fpFilter.checkMandatory(!0,!0,!1)
if(n)return void WUX.showWarning("Specificare i seguenti campi: "+n)
var a=WUX.getComponent("boxFilter")
a instanceof WUX.WBox&&(i.tagsFilter.setState(i.fpFilter.getValues(!0)),a.collapse())
var l=t.getUserLogged()
jrpc.execute("SERVIZI.find",[i.fpFilter.getState(),l.groups],function(s){if(i.tabResult.setState(s),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP,i.selId){var n=e.indexOf(s,t.IServizio.sID_SERVIZIO,i.selId)
n>=0&&setTimeout(function(){i.tabResult.select([n])},100),i.selId=null}})}),this.btnReset=new WUX.WButton(this.subId("br"),t.TXT.RESET,"",WUX.BTN.SM_SECONDARY),this.btnReset.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void WUX.showWarning("Elemento in fase di modifica.")
i.fpFilter.clear(),i.tagsFilter.setState({}),i.tabResult.setState([]),i.fpDetail.clear(),i.status=i.iSTATUS_STARTUP}),this.fpFilter=new WUX.WFormPanel(this.subId("ff")),this.fpFilter.addRow(),this.fpFilter.addTextField(t.IServizio.sID_SERVIZIO,"Codice"),this.fpFilter.addTextField(t.IServizio.sDESCRIZIONE,"Descrizione"),this.fpDetail=new WUX.WFormPanel(this.subId("fpd")),this.fpDetail.addRow(),this.fpDetail.addTextField(t.IServizio.sID_SERVIZIO,"Codice"),this.fpDetail.addTextField(t.IServizio.sDESCRIZIONE,"Descrizione"),this.fpDetail.enabled=!1,this.fpFilter.onEnterPressed(function(t){i.btnFind.trigger("click")}),this.btnNew=new WUX.WButton(this.subId("bn"),t.TXT.NEW,"",WUX.BTN.SM_INFO),this.btnNew.on("click",function(t){if(i.status==i.iSTATUS_EDITING)return void i.btnNew.blur()
i.isNew=!0,i.status=i.iSTATUS_EDITING,i.selId=null,i.tabResult.clearSelection(),i.fpDetail.enabled=!0,i.fpDetail.clear(),setTimeout(function(){i.fpDetail.focus()},100)}),this.btnOpen=new WUX.WButton(this.subId("bo"),t.TXT.OPEN,t.ICO.OPEN,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnOpen.on("click",function(t){if(i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void i.btnOpen.blur()
var e=i.tabResult.getSelectedRows()
if(!e||!e.length)return WUX.showWarning("Seleziona l'elemento da modificare"),void i.btnOpen.blur()
i.isNew=!1,i.status=i.iSTATUS_EDITING,i.selId=null,i.fpDetail.enabled=!0,setTimeout(function(){i.fpDetail.focus()},100)}),this.btnSave=new WUX.WButton(this.subId("bs"),t.TXT.SAVE,t.ICO.SAVE,WUX.BTN.ACT_OUTLINE_PRIMARY),this.btnSave.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return WUX.showWarning("Cliccare su Modifica."),void i.btnSave.blur()
var s=i.fpDetail.checkMandatory(!0)
if(s)return i.btnSave.blur(),void WUX.showWarning("Specificare: "+s)
var n=i.fpDetail.getState()
i.isNew?jrpc.execute("SERVIZI.insert",[n],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IServizio.sID_SERVIZIO],i.btnFind.trigger("click")}):jrpc.execute("SERVIZI.update",[n],function(e){i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=e[t.IServizio.sID_SERVIZIO]
var s=i.tabResult.getSelectedRows()
if(s&&s.length){var n=s[0]
i.tabResult.getState()[n]=e,i.tabResult.refresh(),setTimeout(function(){i.tabResult.select([n])},100)}else i.btnFind.trigger("click")})}),this.btnCancel=new WUX.WButton(this.subId("bc"),t.TXT.CANCEL,t.ICO.CANCEL,WUX.BTN.ACT_OUTLINE_INFO),this.btnCancel.on("click",function(e){if(i.status!=i.iSTATUS_EDITING)return void i.btnCancel.blur()
WUX.confirm(t.MSG.CONF_CANCEL,function(t){t&&(i.isNew?i.fpDetail.clear():i.onSelect(),i.status=i.iSTATUS_VIEW,i.fpDetail.enabled=!1,i.selId=null)})}),this.btnDelete=new WUX.WButton(this.subId("bd"),t.TXT.DELETE,t.ICO.DELETE,WUX.BTN.ACT_OUTLINE_DANGER),this.btnDelete.on("click",function(s){if(i.selId=null,i.btnDelete.blur(),i.status==i.iSTATUS_EDITING||i.status==i.iSTATUS_STARTUP)return void WUX.showWarning("Elemento in fase di modifica.")
var n=i.tabResult.getSelectedRowsData()
if(n&&n.length){var a=e.getString(n[0],t.IServizio.sID_SERVIZIO)
WUX.confirm(t.MSG.CONF_DELETE,function(t){t&&jrpc.execute("SERVIZI.delete",[a],function(t){i.btnFind.trigger("click")})})}})
var s=[["Codice",t.IServizio.sID_SERVIZIO],["Descrizione",t.IServizio.sDESCRIZIONE]]
return this.tabResult=new WUX.WDXTable(this.subId("tr"),e.col(s,0),e.col(s,1)),this.tabResult.css({h:220}),this.tabResult.widths=[100],this.tabResult.onSelectionChanged(function(t){i.onSelect()}),this.cntActions=new t.AppTableActions("ta"),this.cntActions.left.add(this.btnOpen),this.cntActions.left.add(this.btnDelete),this.cntActions.left.add(this.btnSave),this.cntActions.left.add(this.btnCancel),this.cntActions.right.add(this.btnNew),this.tagsFilter=new WUX.WTags("tf"),this.tcoDetail=new WUX.WTab("tcod"),this.tcoDetail.addTab("Attributi",WUX.WIcon.ADDRESS_CARD).addRow().addCol("12",{h:300}).add(this.fpDetail),this.container=new WUX.WContainer,this.container.attributes=WUX.ATT.STICKY_CONTAINER,this.container.addBox("Filtri di ricerca:","","","boxFilter",WUX.ATT.BOX_FILTER).addTool(this.tagsFilter).addCollapse(this.collapseHandler.bind(this)).addRow().addCol("col-xs-11 b-r").add(this.fpFilter).addCol("col-xs-1 b-l").addGroup({classStyle:"form-group text-right"},this.btnFind,this.btnReset).end().addBox().addGroup({classStyle:"search-actions-and-results-wrapper"},this.cntActions,this.tabResult).end().addRow().addCol("12").section("Dettaglio").add(this.tcoDetail),this.container},s.prototype.collapseHandler=function(t){e.getBoolean(t.data,"collapsed")?this.tagsFilter.setState({}):this.tagsFilter.setState(this.fpFilter.getValues(!0))},s.prototype.onSelect=function(){var i=this,s=e.getItem(this.tabResult.getSelectedRowsData(),0)
if(s){var n=e.getString(s,t.IServizio.sID_SERVIZIO)
n&&(this.fpDetail.clear(),this.status==this.iSTATUS_EDITING&&(WUX.showWarning("Modifiche annullate"),this.fpDetail.enabled=!1),jrpc.execute("SERVIZI.read",[n],function(t){i.fpDetail.setState(t),i.status=i.iSTATUS_VIEW}))}},s}(WUX.WComponent)
t.GUIServizi=i}(GUI||(GUI={}))
